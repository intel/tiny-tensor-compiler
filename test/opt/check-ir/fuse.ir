; Copyright (C) 2024 Intel Corporation
; SPDX-License-Identifier: BSD-3-Clause

; RUN: %tinytc-opt -pcheck-ir -O0 < %s | filecheck %s

; No real checks needed, just check that it does not crash
; CHECK: func @t1({{.*}}

func @t1(%0: memref<f32x32x16x8x4x42>) {
  %1 = fuse %0[1,3] : memref<f32x32x512x42>
}
func @t2(%0: memref<f32x32x16x?x4x42>) {
  %1 = fuse %0[1,3] : memref<f32x32x?x42>
}
func @t3(%0: memref<f32x32x16x2x2,strided<1,48,768,1536>>) {
  %1 = fuse %0[1,2] : memref<f32x32x32x2,strided<1,48,1536>>
  %2 = fuse %0[1,2] : memref<f32x32x32x2,strided<1,?,?>>
}
func @t4(%0: memref<f32x8x?x32,strided<1,?,?>>) {
  %2 = fuse %0[0,1] : memref<f32x?x32,strided<1,?>>
}
