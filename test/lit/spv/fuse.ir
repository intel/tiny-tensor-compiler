; Copyright (C) 2024 Intel Corporation
; SPDX-License-Identifier: BSD-3-Clause

; RUN: %tinytc-oc -O0 -S < %s | filecheck %s

; CHECK:     %[[#F32:]] = OpTypeFloat 32
; CHECK: %[[#F32_PTR:]] = OpTypePointer CrossWorkgroup %[[#F32]]
; CHECK:     %[[#I64:]] = OpTypeInt 64 0
; CHECK: %[[#I64_C32:]] = OpConstant %[[#I64]] 32
; CHECK: %[[#I64_C16:]] = OpConstant %[[#I64]] 16
; CHECK:  %[[#I64_C4:]] = OpConstant %[[#I64]] 4
; CHECK: %[[#I64_C42:]] = OpConstant %[[#I64]] 42
; CHECK:  %[[#I64_C0:]] = OpConstant %[[#I64]] 0

func @f1(%0: memref<f32x32x16x?x4x42>) {
  %z = constant 0 : index
  %1 = fuse %0[1,3] : memref<f32x32x?x42>
  %2 = size %1[0] : index
  %3 = size %1[1] : index
  %4 = size %1[2] : index
  %5 = not %2 : index
  %6 = not %3 : index
  %7 = not %4 : index
; CHECK:                %[[#]] = OpFunction {{.*}}
; CHECK-NEXT:      %[[#P_MR:]] = OpFunctionParameter %[[#F32_PTR]]
; CHECK-NEXT:  %[[#P_SHAPE2:]] = OpFunctionParameter %[[#I64]]
; CHECK-NEXT:           %[[#]] = OpFunctionParameter %[[#I64]]
; CHECK-NEXT:           %[[#]] = OpFunctionParameter %[[#I64]]
; CHECK:          %[[#PROD1:]] = OpIMul %[[#I64]] %[[#I64_C16]] %[[#P_SHAPE2]]
; CHECK-NEXT:     %[[#PROD2:]] = OpIMul %[[#I64]] %[[#PROD1]] %[[#I64_C4]]
; CHECK-NEXT:           %[[#]] = OpNot %[[#I64]] %[[#I64_C32]]
; CHECK-NEXT:           %[[#]] = OpNot %[[#I64]] %[[#PROD2]]
; CHECK-NEXT:           %[[#]] = OpNot %[[#I64]] %[[#I64_C42]]
}
