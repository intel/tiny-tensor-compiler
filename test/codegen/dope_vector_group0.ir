; Copyright (C) 2024 Intel Corporation
; SPDX-License-Identifier: BSD-3-Clause

; RUN: %tinytc-oc -O0 < %s | filecheck %s
func @kernel1(%in: group<memref<f32x8x?x9>>) {
; CHECK: void kernel1(global float*global* in, global long* in_shape1, global long* in_stride2)
  %c5 = constant 5 -> index
  %0 = load %in[%c5] : group<memref<f32x8x?x9>>
  ; CHECK-NEXT: long c5 = 5ll;
  ; CHECK-NEXT: global float* x = *(in + c5) + 0;
  ; CHECK-NEXT: long x_shape1 = in_shape1[c5];
  ; CHECK-NEXT: long x_stride2 = in_stride2[c5];
}

func @kernel2(%in: group<memref<f32x?>, offset: ?>) {
; CHECK: void kernel2(global float*global* in, global long* in_shape0, long in_offset)
  %c5 = constant 5 -> index
  %0 = load %in[%c5] : group<memref<f32x?>, offset: ?>
  ; CHECK-NEXT: long c5 = 5ll;
  ; CHECK-NEXT: global float* x = *(in + c5) + in_offset;
  ; CHECK-NEXT: long x_shape0 = in_shape0[c5];
}
