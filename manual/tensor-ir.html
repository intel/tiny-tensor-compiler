
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tensor language reference &#8212; Tiny Tensor Compiler  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/fix-scrollbar-bug.css?v=1c140a14" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'manual/tensor-ir';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Preprocessor reference" href="preprocessor.html" />
    <link rel="prev" title="Calling convention" href="calling_convention.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Tiny Tensor Compiler  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User manual</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="build.html">Building and linking</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core programming guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder.html">Builder programming guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="calling_convention.html">Calling convention</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Tensor language reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessor.html">Preprocessor reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_matrix_chain.html">Tutorial: Matrix chain product</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">tinytc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/core_capi.html">Core C-API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/builder_capi.html">Builder C-API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/core_cxxapi.html">Core C++-API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/builder_cxxapi.html">Builder C++-API</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/cl/index.html">tinytc_cl</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/cl/capi.html">C-API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/cl/cxxapi.html">C++-API</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/sycl/index.html">tinytc_sycl</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/sycl/cxxapi.html">C++-API</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/ze/index.html">tinytc_ze</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/ze/capi.html">C-API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ze/cxxapi.html">C++-API</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../dev/coopmatrix_layout.html">Coopmatrix layout</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/intel/tiny-tensor-compiler" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/intel/tiny-tensor-compiler/blob/main/docs/manual/tensor-ir.rst?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/intel/tiny-tensor-compiler/edit/main/docs/manual/tensor-ir.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/intel/tiny-tensor-compiler/issues/new?title=Issue%20on%20page%20%2Fmanual/tensor-ir.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/manual/tensor-ir.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tensor language reference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execution-model">Execution model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-rules">Core rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifier">Identifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-attributes">Parameter attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restrictions">Restrictions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regions">Regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boolean-type">Boolean type</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-types">Scalar types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memref-type">Memref type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-layout">Memory layout</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#strided-layout">Strided layout</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alignment-attribute">Alignment attribute</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#greatest-common-divisor-gcd-attributes">Greatest common divisor (GCD) attributes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-type">Group type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#group-attributes">Attributes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-type">Cooperative matrix type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Definitions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collective-instructions">Collective instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alloca">Alloca</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Attributes</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axpby">Axpby</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#operands">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-sum">Cumulative sum</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach">Foreach</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach-tile">Foreach tile</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Restrictions</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gemm">GEMM</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gemv">GEMV</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ger">GER</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hadamard-product">Hadamard product</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel">Parallel</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">Sum</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-instructions">Additional instructions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixed-instructions">Mixed instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-binary">Arithmetic (binary)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-unary">Arithmetic (unary)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#associated">Associated</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#returns">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-load">Atomic load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-store">Atomic store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-update">Atomic update</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#barrier">Barrier</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#builtin-mixed">Builtin (mixed)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cast">Cast</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison">Comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#constant">Constant</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#expand">Expand</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for">For</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#arguments">Arguments</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">Returns</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">Attributes</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fuse">Fuse</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id55">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id57">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#if">If</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id58">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id59">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load">Load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id60">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id61">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id62">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#math-unary">Math (unary)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id63">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#size">Size</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id64">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id65">Operands</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subview">Subview</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id66">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id67">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#store">Store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id68">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id69">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id70">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#yield">Yield</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id71">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id72">Operands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spmd-instructions">SPMD instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#builtin-spmd">Builtin (SPMD)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id73">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-apply">Cooperative matrix apply</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id74">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id75">Arguments</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-atomic-load">Cooperative matrix atomic load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id76">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-atomic-store">Cooperative matrix atomic store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id77">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-atomic-update">Cooperative matrix atomic update</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id78">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-construct">Cooperative matrix construct</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id79">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id80">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id81">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-extract">Cooperative matrix extract</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id82">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id83">Operands</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-insert">Cooperative matrix insert</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id84">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id85">Operands</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-load">Cooperative matrix load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id87">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id88">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id89">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-mul-add">Cooperative matrix mul add</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id90">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id91">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id92">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-prefetch">Cooperative matrix prefetch</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id93">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id94">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id95">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-reduce">Cooperative matrix reduce</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id96">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id97">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id98">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-scale">Cooperative matrix scale</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id99">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id100">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id101">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-store">Cooperative matrix store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id103">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id104">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id105">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subgroup-broadcast">Subgroup broadcast</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id106">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id107">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id108">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subgroup-operation">Subgroup operation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id109">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#add">Add</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#max">Max</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#min">Min</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tensor-language-reference">
<span id="tensor-language"></span><h1>Tensor language reference<a class="headerlink" href="#tensor-language-reference" title="Link to this heading">#</a></h1>
<p>The grammar is given in <a class="reference external" href="https://www.ietf.org/rfc/rfc5234.txt">ABNF syntax</a>.</p>
<section id="execution-model">
<h2>Execution model<a class="headerlink" href="#execution-model" title="Link to this heading">#</a></h2>
<p>The unit of execution described by a function written in the tensor language
is called a <strong>kernel</strong>.
Kernels are launched in batches, where each instance of the kernel is called a work-group.
The kernel has access to a three dimensional group id that is used to select the work done in the work group.
Each work group consists of a fixed number of subgroups that execute concurrently.
Subgroups can be further divided into work-items, where the number of work-items per subgroup
is given by the subgroup size.</p>
<p>The language distinguishes between <em>collective</em>, <em>SPMD</em>, and <em>mixed</em> instructions.
A collective instruction distributes the work among the work-items in an implementation-defined manner.
Local variables passed to or returned from a collective instruction are always uniform, meaning
that each work-item holds the same value.
An SPMD instruction follows the OpenCL execution model, where local variables may have a different value
for each work-item.
Mixed instructions accept both varying and uniform local variables.</p>
<p>In an SPMD region, we call an argument <em>dynamically uniform</em> if all work-items in a subgroup have
the same value.</p>
<p>Regions come in two different kinds: collective and SPMD.
A collective instructions must only appear in a collective region, and an SPMD instruction
must only appear in a SPMD region. Mixed instructions might appear in both kinds of regions.
SPMD regions may be nested in collective regions but collective regions must not be nested in SPMD regions.</p>
</section>
<section id="core-rules">
<h2>Core rules<a class="headerlink" href="#core-rules" title="Link to this heading">#</a></h2>
<p>White space is used to separate tokens, where a token is either an identifier,
a literal, a keyword, or characters such as punctuation or delimiters.
Otherwise, white space has no meaning.</p>
<p>Comments start with <code class="docutils literal notranslate"><span class="pre">;</span></code> and stop at the end of the line (<code class="docutils literal notranslate"><span class="pre">\n</span></code>).</p>
</section>
<section id="identifier">
<h2>Identifier<a class="headerlink" href="#identifier" title="Link to this heading">#</a></h2>
<p>Identifiers are either named or unnamed.
Named identifiers are letter followed by letters, underscores, or digits.
Unnamed identifiers are simply numbers.
As in LLVM, local identifiers are prefixed with <code class="docutils literal notranslate"><span class="pre">%</span></code>, whereas global identifiers
are prefixed with <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>.</p>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">identifier</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="nc">unnamed-identifier</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">named-identifier</span>
<span class="nc">unnamed-identifier</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span>
<span class="nc">named-identifier</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="k">ALPHA</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="k">ALPHA</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">DIGIT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;_&quot;</span><span class="p">)</span>
<span class="nc">local-identifier</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;%&quot;</span><span class="w"> </span><span class="nc">identifier</span>
<span class="nc">global-identifier</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;@&quot;</span><span class="w"> </span><span class="nc">identifier</span>
</pre></div>
</div>
</section>
<section id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Link to this heading">#</a></h2>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">constant</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="nc">boolean-constant</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">floating-constant</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">complex-constant</span>
<span class="nc">boolean-constant</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;true&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;false&quot;</span>
<span class="nc">integer-constant</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nc">sign</span><span class="p">]</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span>
<span class="nc">sign</span><span class="w">                        </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;-&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;+&quot;</span>
<span class="nc">floating-constant</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nc">sign</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">DIGIT</span><span class="w"> </span><span class="l">&quot;.&quot;</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;e&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">sign</span><span class="p">]</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;inf&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;nan&quot;</span><span class="p">)</span>
<span class="nc">mantissa-dec</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="k">DIGIT</span><span class="w"> </span><span class="l">&quot;.&quot;</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span><span class="w"> </span><span class="l">&quot;.&quot;</span>
<span class="nc">mantissa-hex</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="k">HEXDIG</span><span class="w"> </span><span class="l">&quot;.&quot;</span><span class="w"> </span><span class="o">1*</span><span class="k">HEXDIG</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">1*</span><span class="k">HEXDIG</span><span class="w"> </span><span class="l">&quot;.&quot;</span>
<span class="nc">exponent</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nc">sign</span><span class="p">]</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span>
<span class="nc">floating-constant-dec</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nc">sign</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="nc">mantissa-dec</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;e&quot;</span><span class="w"> </span><span class="nc">exponent</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">1*</span><span class="k">DIGIT</span><span class="w"> </span><span class="l">&quot;e&quot;</span><span class="w"> </span><span class="nc">exponent</span><span class="p">)</span>
<span class="nc">floating-constant-hex</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nc">sign</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;0x&quot;</span><span class="w"> </span><span class="p">(</span><span class="nc">mantissa-hex</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;p&quot;</span><span class="w"> </span><span class="nc">exponent</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">1*</span><span class="k">HEXDIG</span><span class="w"> </span><span class="l">&quot;p&quot;</span><span class="w"> </span><span class="nc">exponent</span><span class="p">)</span>
<span class="nc">floating-constant</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nc">floating-constant-dec</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">floating-constant-hex</span>
<span class="nc">complex-constant</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">floating-constant</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">floating-constant</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
</pre></div>
</div>
<p>Integer constants must lie in the range <span class="math notranslate nohighlight">\(-2^{63}+1,\dots,2^{63}-1\)</span>.</p>
<p>Floating point constants are given in C syntax and expected to be in the range of double precision numbers.
The hexadecimal floating point syntax is supported, too.
<a class="reference external" href="https://en.cppreference.com/w/c/string/byte/strtof">strtod</a> can be used for parsing floating
point numbers.</p>
</section>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">#</a></h2>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">attribute</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="nc">array-attribute</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="nc">boolean-attribute</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="nc">dictionary-attribute</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="nc">integer-attribute</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="nc">string-attribute</span>
<span class="nc">array-attribute</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">attribute</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;, &quot;</span><span class="w"> </span><span class="nc">attribute</span><span class="p">)]</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="nc">boolean-attribute</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nc">boolean-constant</span>
<span class="nc">dictionary-attribute</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;{&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">named-attribute</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">named-attribute</span><span class="p">)]</span><span class="w"> </span><span class="l">&quot;}&quot;</span>
<span class="nc">named-attribute</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nc">attribute-name</span><span class="w"> </span><span class="l">&quot;=&quot;</span><span class="w"> </span><span class="nc">attribute</span>
<span class="nc">attribute-name</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;alignment&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="l">&quot;shape_gcd&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="l">&quot;stride_gcd&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="l">&quot;subgroup_size&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="l">&quot;unroll&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="l">&quot;work_group_size&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                              </span><span class="nc">string-attribute</span>
<span class="nc">integer-attribute</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nc">integer-constant</span>
<span class="nc">string-attribute</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="l">%x22</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">%x20-21</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">%x23-7E</span><span class="p">)</span><span class="w"> </span><span class="l">%x22</span>
</pre></div>
</div>
<p>Attributes add information about an operation, for example to assert properties or to direct the compiler.</p>
</section>
<section id="functions">
<span id="tensor-language-functions"></span><h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">function-definition</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;func&quot;</span><span class="w"> </span><span class="nc">global-identifier</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">argument-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;)&quot;</span>
<span class="w">                              </span><span class="p">[</span><span class="l">&quot;attributes&quot;</span><span class="w"> </span><span class="nc">dictionary-attribute</span><span class="p">]</span><span class="w"> </span><span class="nc">region</span>
<span class="nc">argument-list</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="nc">argument</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">argument</span><span class="p">)</span>
<span class="nc">argument</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">type</span><span class="w"> </span><span class="p">[</span><span class="nc">dictionary-attribute</span><span class="p">]</span>
</pre></div>
</div>
<p>Defines a function that is callable from the host.</p>
<section id="id1">
<h3>Attributes<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Subgroup size and work-group size are determined automatically by the compiler, but can be overriden
using the function’s attribute dictionary:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Type</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>subgroup_size</p></td>
<td><p>integer-attribute</p></td>
<td><p>Subgroup size; valid values depend on the target device (typically 16 or 32)</p></td>
</tr>
<tr class="row-odd"><td><p>work_group_size</p></td>
<td><p>array-attribute with 2 integer-attribute entries</p></td>
<td><p>Two dimensional work-group size in number of work-items</p></td>
</tr>
</tbody>
</table>
</div>
<p>The work-group size attribute defines the size of the local work group.
Due to the focus on matrix operations, the work-group size is always two-dimensional,
where the first mode is used to tile the rows and the second mode is used
to tile the columns.
The first mode must be a multiple of the subgroup size.
If the subgroup size is omitted, then the first mode must be a multiple of one of
the subgroup sizes supported by the device.
The product of the work-group size modes must be smaller or equal than the maximum
work-group size of device.</p>
<p>The subgroup size attribute enforces a particular subgroup size that must be supported by
the device.</p>
</section>
<section id="parameter-attributes">
<h3>Parameter attributes<a class="headerlink" href="#parameter-attributes" title="Link to this heading">#</a></h3>
<p>Parameters with memref or group type accept the following named attributes:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Type</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>alignment</p></td>
<td><p>integer-attribute</p></td>
<td><p>Minimum pointer alignment</p></td>
</tr>
<tr class="row-odd"><td><p>shape_gcd</p></td>
<td><p>array-attribute of integer-attribute</p></td>
<td><p>Greatest common divisors of shape</p></td>
</tr>
<tr class="row-even"><td><p>stride_gcd</p></td>
<td><p>array-attribute of integer-attribute</p></td>
<td><p>Greatest common divisors of stride</p></td>
</tr>
</tbody>
</table>
</div>
<p>Cf. the documentation of the <a class="reference internal" href="#memref-attributes"><span class="std std-ref">memref type</span></a> and the <a class="reference internal" href="#group-attributes"><span class="std std-ref">group type</span></a>.</p>
</section>
<section id="restrictions">
<h3>Restrictions<a class="headerlink" href="#restrictions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Arguments must not have coopmatrix type.</p></li>
</ul>
</section>
</section>
<section id="regions">
<h2>Regions<a class="headerlink" href="#regions" title="Link to this heading">#</a></h2>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">region</span><span class="w">                      </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;{&quot;</span><span class="w"> </span><span class="o">*</span><span class="nc">instruction</span><span class="w"> </span><span class="l">&quot;}&quot;</span>
</pre></div>
</div>
<p>A region is an ordered list of instructions.
An instruction might contain a region.
Regions have access to values from its enclosing region, but the enclosing region does not have access to
values assigned in the region.</p>
</section>
<section id="types">
<h2>Types<a class="headerlink" href="#types" title="Link to this heading">#</a></h2>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">type</span><span class="w">                        </span><span class="o">=</span><span class="w"> </span><span class="nc">void-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">boolean-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">number-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">memref-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">group-type</span>
<span class="nc">void-type</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;void&quot;</span>
</pre></div>
</div>
<section id="boolean-type">
<h3>Boolean type<a class="headerlink" href="#boolean-type" title="Link to this heading">#</a></h3>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">boolean-type</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;bool&quot;</span>
</pre></div>
</div>
<p>Boolean type that only has two states (true or false).</p>
</section>
<section id="scalar-types">
<h3>Scalar types<a class="headerlink" href="#scalar-types" title="Link to this heading">#</a></h3>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">number-type</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="nc">integer-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">floating-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">complex-type</span>
<span class="nc">integer-type</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;i8&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;i16&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;i32&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;i64&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;index&quot;</span>
<span class="nc">floating-type</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;bf16&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;f16&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;f32&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;f64&quot;</span>
<span class="nc">complex-type</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;c32&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;c64&quot;</span>
</pre></div>
</div>
<p>Scalar types are either signless integer (“i”), floating point (“f”),
or complex floating point (“c”).
The number behind the scalar type prefix denotes the number of bits,
e.g. “f64” are double precision floating point numbers.
The “bf16” type encodes bfloat16 floating point numbers.
The “index” type is an integer type whose width is platform-specific.</p>
<p>Type sizes in bytes are given by</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></th>
<th class="head"><p>i8</p></th>
<th class="head"><p>i16</p></th>
<th class="head"><p>i32</p></th>
<th class="head"><p>i64</p></th>
<th class="head"><p>bf16</p></th>
<th class="head"><p>f16</p></th>
<th class="head"><p>f32</p></th>
<th class="head"><p>f64</p></th>
<th class="head"><p>c32</p></th>
<th class="head"><p>c64</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{size}(\alpha)\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>16</p></td>
</tr>
</tbody>
</table>
</div>
<p>Mixed precision operands might be allowed in instructions if the operands’ types are <em>promotable</em>.
The scalar type <span class="math notranslate nohighlight">\(\alpha\)</span> may be promoted to the scalar type <span class="math notranslate nohighlight">\(\beta\)</span> if all values an operand
of type <span class="math notranslate nohighlight">\(\alpha\)</span> may take can be exactly represented in type <span class="math notranslate nohighlight">\(\beta\)</span>.
Formally, <span class="math notranslate nohighlight">\(\alpha\)</span> is promotable to <span class="math notranslate nohighlight">\(\beta\)</span> if <span class="math notranslate nohighlight">\(\alpha \preceq \beta\)</span>,
where the partial order <span class="math notranslate nohighlight">\(\preceq\)</span> is defined by the following relation matrix:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(\preceq\)</span></p></th>
<th class="head"><p>i8</p></th>
<th class="head"><p>i16</p></th>
<th class="head"><p>i32</p></th>
<th class="head"><p>i64</p></th>
<th class="head"><p>bf16</p></th>
<th class="head"><p>f16</p></th>
<th class="head"><p>f32</p></th>
<th class="head"><p>f64</p></th>
<th class="head"><p>c32</p></th>
<th class="head"><p>c64</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>i8</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>i16</p></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>i32</p></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>i64</p></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>bf16</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>f16</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>f32</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>f64</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>c32</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>c64</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</div>
<p>Moreover, for scalar types <span class="math notranslate nohighlight">\(\alpha,\beta\)</span> we define</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{promote}(\alpha, \beta) = \left\{\begin{array}{rcl}
    \beta &amp; \text{ if } &amp; \alpha \preceq \beta, \\
    \alpha &amp; \text{ if } &amp; \beta \preceq \alpha, \\
    \text{fail} &amp; \text{ else.}
\end{array}\right.\end{split}\]</div>
<p>Here, “fail” means that the promotion is not allowed and the compiler should throw an error.</p>
</section>
<section id="memref-type">
<h3>Memref type<a class="headerlink" href="#memref-type" title="Link to this heading">#</a></h3>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">memref-type</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;memref&lt;&quot;</span><span class="w"> </span><span class="nc">number-type</span><span class="w"> </span><span class="nc">tensor-shape</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">memory-layout</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">address-space</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;&gt;&quot;</span>
<span class="nc">constant-or-dynamic</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;?&quot;</span>
<span class="nc">tensor-shape</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;x&quot;</span><span class="w"> </span><span class="nc">constant-or-dynamic</span><span class="p">)</span>
<span class="nc">address-space</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;global&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;local&quot;</span>
</pre></div>
</div>
<p>A memref is a reference to a region of memory.
In analogy to the C/C++-language, the memref can be thought of as a pointer,
but with additional information on the size and memory layout of the memory region.
The size information can be either fixed or dynamic.
For example, the <code class="docutils literal notranslate"><span class="pre">memref&lt;f32x4x8&gt;</span></code> is analogue to <code class="docutils literal notranslate"><span class="pre">float*</span></code> with the additional information
that the memory region contains 32 floats structured in 4 rows and 8 columns.
The <code class="docutils literal notranslate"><span class="pre">memref&lt;f32x4x?&gt;</span></code> type is analogue to <code class="docutils literal notranslate"><span class="pre">float*</span></code>, too, but here the number of floats
and the number of columns is only known at run-time.</p>
<p>Run-time size information is stored in a dope vector; the calling convention for memrefs is
implementation-defined.</p>
<p>The memref can have order 0. E.g. <code class="docutils literal notranslate"><span class="pre">memref&lt;f32&gt;</span></code> can be thought of as a pointer to a single precision float.
A vector is a tensor of order 1, e.g. <code class="docutils literal notranslate"><span class="pre">memref&lt;f64x4&gt;</span></code>.
A matrix is a tensor of order 2, e.g. <code class="docutils literal notranslate"><span class="pre">memref&lt;f64x4x4&gt;</span></code>.
A tensor of order n is given by <code class="docutils literal notranslate"><span class="pre">memref&lt;f32xs_1x...xs_n&gt;</span></code>.</p>
<p>Dynamic mode sizes are written using a question mark in place of an integer constant.</p>
<p>The default memory layout is the packed dense layout.
E.g. the memory layout of <code class="docutils literal notranslate"><span class="pre">memref&lt;f32x5x6x7&gt;</span></code> is <code class="docutils literal notranslate"><span class="pre">strided&lt;1,5,30&gt;</span></code>.
We note that <code class="docutils literal notranslate"><span class="pre">memref&lt;f32x5x6x7&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">memref&lt;f32x5x6x7,strided&lt;1,5,30&gt;&gt;</span></code>
are the same type.</p>
<p>Memrefs have an optional address space attribute.
The global address space referse to memory objects allocated from the global memory pool
that is shared by all work groups.
The local memory space is shared by all work-items of the work-group but inaccessible to another work-group.
The default address space is “global”, memrefs with “local” address space are returned by
the alloca instruction.</p>
<section id="definitions">
<h4>Definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h4>
<p>Let V be a value of memref type.
The <span class="math notranslate nohighlight">\(\text{order}(V)\)</span> operation returns the memref’s order.
The <span class="math notranslate nohighlight">\(\text{shape}(V)\)</span> returns the tensor shape as tuple.
<span class="math notranslate nohighlight">\(\text{rows}(V)\)</span> and <span class="math notranslate nohighlight">\(\text{columns}(V)\)</span> return the size of the first
and second mode, respectively.
The <span class="math notranslate nohighlight">\(\text{element_type}(V)\)</span> operation gives the underlying scalar type.</p>
<p>For example, let B be a value of memref&lt;f32x8x16x4&gt; type, then</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(B) = 3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{shape}(B) = (8,16,4)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rows}(B) = 8\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{columns}(B) = 16\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{element_type}(B) = \text{f32}\)</span></p></li>
</ul>
</section>
<section id="memory-layout">
<h4>Memory layout<a class="headerlink" href="#memory-layout" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">memory-layout</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="nc">strided-layout</span>
</pre></div>
</div>
<section id="strided-layout">
<span id="id2"></span><h5>Strided layout<a class="headerlink" href="#strided-layout" title="Link to this heading">#</a></h5>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">strided-layout</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;strided&lt;&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">constant-or-dynamic-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;&gt;&quot;</span>
<span class="nc">constant-or-dynamic-list</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nc">constant-or-dynamic</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">constant-or-dynamic</span><span class="p">)</span>
</pre></div>
</div>
<p>The strided layout is a sequence of integers <span class="math notranslate nohighlight">\(S_1,S_2,...,S_n\)</span>, where <em>n</em> must be equal
to the order of the tensor.
The strided layout is defined as the map</p>
<div class="math notranslate nohighlight">
\[(i_1,i_2,...,i_n) \mapsto i_1 S_1 + i_2 S_2 + ... + i_n S_n\]</div>
<p>We further impose the following restriction for a tensor with shape <span class="math notranslate nohighlight">\(s_1\times s_2 \times ... \times s_n\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1 \leq S_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\forall i \in [2,n]: S_{i-1}s_{i-1} \leq S_i\)</span></p></li>
</ul>
<p>Therefore, we have the “column-major” layout.
The default packed dense layout is given by</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1 = S_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\forall i \in [2,n]: S_{i-1}s_{i-1} = S_i\)</span></p></li>
</ul>
<p>Stride modes might be dynamic as well, indicated by a question mark.</p>
</section>
</section>
<section id="alignment-attribute">
<span id="memref-attributes"></span><h4>Alignment attribute<a class="headerlink" href="#alignment-attribute" title="Link to this heading">#</a></h4>
<p>The <em>alignment=X</em> attribute gives the alignment X of the memref’s base pointer in bytes.
That is, for the pointer P pointing to the first element of the memref we must have <span class="math notranslate nohighlight">\(P = 0 \pmod{X}\)</span>.</p>
<p><strong>Restriction:</strong> The alignment must be a multiple of the size of the memref’s element type.</p>
</section>
<section id="greatest-common-divisor-gcd-attributes">
<h4>Greatest common divisor (GCD) attributes<a class="headerlink" href="#greatest-common-divisor-gcd-attributes" title="Link to this heading">#</a></h4>
<p>The <em>shape_gcd=[d_1,…,d_k]</em> attribute asserts that <span class="math notranslate nohighlight">\(s_i = 0 \pmod{d_i}, i=1,\dots,k\)</span>, where k is
smaller or equal than the order of the tensor n and <span class="math notranslate nohighlight">\(s_i\)</span> is the i-th entry of the shape vector.
The divisors are understood to be the greatest common divisors for the set of shapes that the kernel is used for.
For example, if we know that <span class="math notranslate nohighlight">\(s_1\)</span> is always a multiple of 4 then we can set <em>shape_gcd=[4]</em>.</p>
<p>The <em>stride_gcd=[D_1,…,D_m]</em> attribute asserts that <span class="math notranslate nohighlight">\(S_i = 0 \pmod{D_i}, i=1,\dots,m\)</span>, where m is
smaller or equal than the order of the tensor n and <span class="math notranslate nohighlight">\(S_i\)</span> is the i-th entry of the stride vector.
The divisors are understood to be the greatest common divisors for the set of strides that the kernel is used for.
For example, if we know that <span class="math notranslate nohighlight">\(S_2\)</span> is always a multiple of 4 then we can set <em>stride_gcd=[1,4]</em>.</p>
</section>
</section>
<section id="group-type">
<h3>Group type<a class="headerlink" href="#group-type" title="Link to this heading">#</a></h3>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">group-type</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;group&lt;&quot;</span><span class="w"> </span><span class="nc">memref-type</span><span class="w"> </span><span class="l">&quot;x&quot;</span><span class="w"> </span><span class="nc">constant-or-dynamic</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="l">&quot;offset&quot;</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">constant-or-dynamic</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;&gt;&quot;</span>
</pre></div>
</div>
<p>The group type collects unstructured pointers to memref’s with potentially different dynamic mode sizes.
The C-analogy of a group is a pointer-to-a-pointer.
For example, the C-analogue of a <code class="docutils literal notranslate"><span class="pre">group&lt;memref&lt;f32x16x16&gt;x?&gt;</span></code> is a <code class="docutils literal notranslate"><span class="pre">float**</span></code>.</p>
<p>The group shape is always one-dimensional and may be queried using the
<a class="reference internal" href="#size-instruction"><span class="std std-ref">size instruction</span></a>.</p>
<p>The optional offset parameter is used to offset each pointer by the given number of elements.
Given the C-analogue <code class="docutils literal notranslate"><span class="pre">float**</span> <span class="pre">group</span></code>, loading element <code class="docutils literal notranslate"><span class="pre">i</span></code> with offset <code class="docutils literal notranslate"><span class="pre">off</span></code> gives the
pointer <code class="docutils literal notranslate"><span class="pre">float*</span> <span class="pre">tmp</span> <span class="pre">=</span> <span class="pre">group[i]</span> <span class="pre">+</span> <span class="pre">off</span></code>.
The default offset is 0.</p>
<p>Dynamic values (‘?’) may appear in the memref-type, in the group shape, and in the offset.
These values are stored in the dope vector;
the calling convention for groups is implementation-defined.</p>
<section id="group-attributes">
<span id="id3"></span><h4>Attributes<a class="headerlink" href="#group-attributes" title="Link to this heading">#</a></h4>
<p>Attributes applied on a group type are passed through to the memrefs.
That is, when a memref is loaded from the group then the <a class="reference internal" href="#memref-attributes"><span class="std std-ref">memref attributes</span></a>
are equal to the attributes of the group.</p>
</section>
</section>
<section id="cooperative-matrix-type">
<h3>Cooperative matrix type<a class="headerlink" href="#cooperative-matrix-type" title="Link to this heading">#</a></h3>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">coopmatrix-type</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;coopmatrix&lt;&quot;</span><span class="w"> </span><span class="nc">number-type</span><span class="w"> </span><span class="o">2*2</span><span class="p">(</span><span class="l">&quot;x&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="p">)</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">matrix-use</span><span class="w"> </span><span class="l">&quot;&gt;&quot;</span>
<span class="nc">matrix-use</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;matrix_a&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;matrix_b&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;matrix_acc&quot;</span>
</pre></div>
</div>
<p>The coopmatrix represents a matrix distributed across a subgroup, where each work-item in a subgroup
stores a part of the matrix.
The number-type specifies the matrix element type, the first integer-constant the number of rows,
and the second integer-constant the number of columns.
The matrix-use may affect the distribution of the matrix in the subgroup, and the name refers to the
position of the matrix in a matrix multiplication.</p>
<p>Not all matrix shapes need to be supported in the implementation.
The supported matrix shapes may depend on data type, matrix use, and target hardware.</p>
<p>An argument to any instruction that has coopmatrix type <strong>must</strong> be dynamically uniform.</p>
<section id="id4">
<h4>Definitions<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>Let V be a value of coopmatrix type.
The <span class="math notranslate nohighlight">\(\text{rows}(V)\)</span> and <span class="math notranslate nohighlight">\(\text{columns}(V)\)</span> functions return the size of the first
and second mode, respectively, and <span class="math notranslate nohighlight">\(\text{shape}(V)\)</span> returns rows and cols as tuple.
The <span class="math notranslate nohighlight">\(\text{component_type}(V)\)</span> operation gives the underlying scalar type
and <span class="math notranslate nohighlight">\(\text{use}(V)\)</span> returns the use.</p>
<p>For example, let B be a value of coopmatrix&lt;f32x8x16,matrix_acc&gt; type, then</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{shape}(B) = (8,16)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rows}(B) = 8\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{columns}(B) = 16\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{component_type}(B) = \text{f32}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{use}(B) = \text{matrix_acc}\)</span></p></li>
</ul>
</section>
</section>
</section>
<section id="instructions">
<h2>Instructions<a class="headerlink" href="#instructions" title="Link to this heading">#</a></h2>
<p>Instructions may return zero, one, or multiple values, and follow the following format:</p>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction-assignment</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;=&quot;</span><span class="w"> </span><span class="nc">value-instruction</span>
<span class="nc">multi-value-instruction-assignment</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;=&quot;</span><span class="p">]</span><span class="w"> </span><span class="nc">multi-value-instruction</span>
<span class="nc">local-identifier-list</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="p">)</span>
<span class="nc">instruction</span><span class="w">                         </span><span class="o">=</span><span class="w"> </span><span class="nc">value-instruction-assignment</span>
<span class="w">                                      </span><span class="o">/</span><span class="w"> </span><span class="nc">multi-value-instruction-assignment</span>
</pre></div>
</div>
<p>That is, on the left-hand side we have list of values that are produced by the instruction followed by an equals sign,
or an empty string, if the instruction does not produce values.
On the right-hand side, after the equals sign or empty string, the name of the instruction is written, e.g. “ger”, optionally followed by instruction modifiers, e.g. “ger.atomic”.
Then, a list of operands follows that is usually comma-seperated but might also be printed in a custom format
(e.g. for “load”, “store”, “subview”, etc.).
If the instruction produces values, then the types of the returned values must be annotated after a colon.</p>
<section id="collective-instructions">
<h3>Collective instructions<a class="headerlink" href="#collective-instructions" title="Link to this heading">#</a></h3>
<section id="alloca">
<h4>Alloca<a class="headerlink" href="#alloca" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;alloca&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">dictionary-attribute</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">memref-type</span>
</pre></div>
</div>
<section id="overview">
<h5>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h5>
<p>The alloca instruction allocates temporary memory that is freed automatically at the end of the block that contains the alloca.</p>
</section>
<section id="id5">
<h5>Attributes<a class="headerlink" href="#id5" title="Link to this heading">#</a></h5>
<p>Alloca accepts the following named attributes:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Type</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>alignment</p></td>
<td><p>integer-attribute</p></td>
<td><p>Base pointer alignment; must not be larger than the <a class="reference internal" href="../api/core_capi.html#tinytc-core-info-get-default-alignment"><span class="std std-ref">default alignment</span></a>.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id6">
<h5>Restrictions<a class="headerlink" href="#id6" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>The memref’s size must known at compile-time, i.e. the tensor shape must not contain any dynamic modes.</p></li>
<li><p>The address space must be “local”.</p></li>
</ul>
</section>
</section>
<section id="axpby">
<h4>Axpby<a class="headerlink" href="#axpby" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">transpose</span><span class="w">       </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;.t&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;.n&quot;</span>
<span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;axpby&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.atomic&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                           </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id7">
<h5>Overview<a class="headerlink" href="#id7" title="Link to this heading">#</a></h5>
<p>Axpby implements</p>
<div class="math notranslate nohighlight">
\[B := \alpha \text{op}(A) + \beta B\]</div>
<p>for vectors and matrices, where <span class="math notranslate nohighlight">\(\text{op}(X)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{op}(X) := \left\{
                \begin{array}{rcl}
                    X^T &amp; \text{ if } &amp; \text{transpose} = \text{&quot;.t&quot;} \wedge \text{order}(X) = 2,\\
                    X   &amp; \text{ else. }
                \end{array}
                \right.\end{split}\]</div>
<p>If the atomic flag is set, B is updated atomically.</p>
</section>
<section id="operands">
<h5>Operands<a class="headerlink" href="#operands" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>memref-type</p></td>
<td><p>B</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id8">
<h5>Restrictions<a class="headerlink" href="#id8" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{shape}(B) = \text{shape}(\text{op}(A))\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{order}(B) = 0 \lor \text{order}(B) = 1 \lor \text{order}(B) = 2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\alpha) \preceq \text{element_type}(A) \preceq \text{element_type}(B)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\beta) \preceq \text{element_type}(B)\)</span></p></li>
<li><p>If the atomic flag is set, <span class="math notranslate nohighlight">\(\beta\)</span> must be constant and <span class="math notranslate nohighlight">\(\beta \in \{0,1\}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="cumulative-sum">
<h4>Cumulative sum<a class="headerlink" href="#cumulative-sum" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cumsum&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.atomic&quot;</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                            </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id9">
<h5>Overview<a class="headerlink" href="#id9" title="Link to this heading">#</a></h5>
<p>Computes the n-mode cumulative sum</p>
<div class="math notranslate nohighlight">
\[B := \alpha A \times_{n} L_{s_n} + \beta B,\]</div>
<p>where <span class="math notranslate nohighlight">\(L_{s_n}\)</span> is the lower triangular matrix of ones of size <span class="math notranslate nohighlight">\(s_n\times s_n\)</span> and
<span class="math notranslate nohighlight">\(s_n\)</span> is the n-th entry of the shape vector of A.
In index notation, we have equivalently</p>
<div class="math notranslate nohighlight">
\[B_{i_1\dots i_{n-1}ji_{n+1}\dots i_M}
    := \alpha \sum_{i_n=1}^{j}A_{i_1\dots i_{n-1}i_ni_{n+1}\dots i_M}
       + \beta B_{i_1\dots i_{n-1}ji_{n+1}\dots i_M},\]</div>
<p>If the atomic flag is set, B is updated atomically.</p>
</section>
<section id="id10">
<h5>Operands<a class="headerlink" href="#id10" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>integer-constant</p></td>
<td><p>n (summation mode)</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>memref-type</p></td>
<td><p>B</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id11">
<h5>Restrictions<a class="headerlink" href="#id11" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(A) \geq 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{shape}(A) = \text{shape}(B)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\alpha) \preceq \text{element_type}(A) \preceq \text{element_type}(B)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\beta) \preceq \text{element_type}(B)\)</span></p></li>
<li><p>If the atomic flag is set, <span class="math notranslate nohighlight">\(\beta\)</span> must be constant and <span class="math notranslate nohighlight">\(\beta \in \{0,1\}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="foreach">
<h4>Foreach<a class="headerlink" href="#foreach" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;foreach&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="l">&quot;=&quot;</span>
<span class="w">                   </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="nc">region</span>
</pre></div>
</div>
<section id="id12">
<h5>Overview<a class="headerlink" href="#id12" title="Link to this heading">#</a></h5>
<p>A foreach loop that executes the loop’s range without any sequence guarantee.
The region of a foreach is a <em>spmd region</em>.</p>
<p>The three local identifier lists define the loop range and the local identifiers that
make the trip count available within the loop body.
All three lists must have the same length and have the following format:</p>
<div class="math notranslate nohighlight">
\[(\text{var}_1, \dots, \text{var}_N) = (\text{from}_1, \dots, \text{from}_N),
                                      (\text{to}_1, \dots, \text{to}_N),\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the common length of each of the three lists.
The loop range is defined as the cartesian product of the half-open intervals
<span class="math notranslate nohighlight">\([\text{from}_i; \text{to}_i)\)</span> such that the trip count take the values</p>
<div class="math notranslate nohighlight">
\[(\text{var}_1, \dots, \text{var}_N) \in [\text{from}_1; \text{to}_1) \times \dots \times
[\text{from}_N; \text{to}_N)\]</div>
<p>The integer type of a “from” and “to” pair must match.</p>
<p>The mapping of trip count to work-item is implementation-defined.</p>
</section>
</section>
<section id="foreach-tile">
<h4>Foreach tile<a class="headerlink" href="#foreach-tile" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;foreach_tile&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="l">&quot;=&quot;</span>
<span class="w">                   </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span>
<span class="w">                   </span><span class="l">&quot;as&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="l">&quot;&lt;=&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">integer-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span>
<span class="w">                   </span><span class="nc">region</span>
<span class="nc">integer-list</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="p">)</span>
</pre></div>
</div>
<section id="id13">
<h5>Overview<a class="headerlink" href="#id13" title="Link to this heading">#</a></h5>
<p>A foreach loop that partitions the loop range into tiles.
The region of a foreach_tile is a <em>spmd region</em>.</p>
<p>The first three local identifier lists define the loop range and the local identifiers that
make the tile offset available within the loop body.
All three lists must have the same length and have the following format:</p>
<div class="math notranslate nohighlight">
\[(\text{var}_1, \dots, \text{var}_N) = (\text{from}_1, \dots, \text{from}_N),
                                      (\text{to}_1, \dots, \text{to}_N),\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the common length of each of the three lists and
the integer type of a “from” and “to” pair must match.
After “as” comes an identifier list that makes the tile shape available in the loop body
and the constant upper bound for the tile shape, following the format</p>
<div class="math notranslate nohighlight">
\[(\text{size}_1, \dots, \text{size}_N) \leq (\text{tile_shape}_1, \dots, \text{tile_shape}_N).\]</div>
<p>The number of tiles in mode <span class="math notranslate nohighlight">\(i=1,\dots,N\)</span>
is given by <span class="math notranslate nohighlight">\(K_i = \lceil(\text{to}_i-\text{from}_i) / \text{tile_shape}_i\rceil\)</span>
and the tile offset takes the following values:</p>
<div class="math notranslate nohighlight">
\[\text{var}_i = \text{from}_i+k\cdot \text{tile_shape}_i, \quad k=0,\dots,K_i-1.\]</div>
<p>The size variable is given by</p>
<div class="math notranslate nohighlight">
\[\text{size}_i = \min(\text{tile_shape}_i, \text{to}_i - \text{var}_i).\]</div>
<p>Therefore, the size is equal to the tile shape except for the loop remainder.</p>
</section>
<section id="id14">
<h5>Restrictions<a class="headerlink" href="#id14" title="Link to this heading">#</a></h5>
<p>The first entry of the tile shape (<span class="math notranslate nohighlight">\(\text{tile_shape}_1\)</span>) <strong>must</strong> be a multiple of the subgroup size.
The tile offsets (<span class="math notranslate nohighlight">\(\text{var}_i\)</span>) <strong>must</strong> be <em>dynamically uniform</em>.</p>
</section>
<section id="example">
<h5>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">foreach_tile</span> <span class="p">(</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="o">%</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="o">%</span><span class="n">c0</span><span class="p">,</span><span class="o">%</span><span class="n">c0</span><span class="p">),(</span><span class="o">%</span><span class="n">c70</span><span class="p">,</span><span class="o">%</span><span class="n">c64</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="o">%</span><span class="n">ti</span><span class="p">,</span><span class="o">%</span><span class="n">tj</span><span class="p">)</span><span class="o">&lt;=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">%</span><span class="n">c32</span> <span class="o">=</span> <span class="n">constant</span> <span class="mi">32</span> <span class="p">:</span> <span class="n">index</span>
    <span class="o">%</span><span class="n">is_remainder</span> <span class="o">=</span> <span class="n">less_than</span> <span class="o">%</span><span class="n">ti</span><span class="p">,</span> <span class="o">%</span><span class="n">c32</span> <span class="p">:</span> <span class="nb">bool</span>
    <span class="k">if</span> <span class="o">%</span><span class="n">is_remainder</span> <span class="p">{</span>
        <span class="o">%</span><span class="n">tile</span> <span class="o">=</span> <span class="n">cooperative_matrix_load</span><span class="o">.</span><span class="n">rows_checked</span> <span class="o">%</span><span class="n">A</span><span class="p">[</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="o">%</span><span class="n">j</span><span class="p">]</span> <span class="p">:</span> <span class="n">coopmatrix</span><span class="o">&lt;</span><span class="n">f32x32x32</span><span class="p">,</span><span class="n">matrix_acc</span><span class="o">&gt;</span>
        <span class="n">cooperative_matrix_store</span><span class="o">.</span><span class="n">rows_checked</span> <span class="o">%</span><span class="n">tile</span><span class="p">,</span> <span class="o">%</span><span class="n">B</span><span class="p">[</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="o">%</span><span class="n">j</span><span class="p">]</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="o">%</span><span class="n">tile</span> <span class="o">=</span> <span class="n">cooperative_matrix_load</span> <span class="o">%</span><span class="n">A</span><span class="p">[</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="o">%</span><span class="n">j</span><span class="p">]</span> <span class="p">:</span> <span class="n">coopmatrix</span><span class="o">&lt;</span><span class="n">f32x32x32</span><span class="p">,</span><span class="n">matrix_acc</span><span class="o">&gt;</span>
        <span class="n">cooperative_matrix_store</span> <span class="o">%</span><span class="n">tile</span><span class="p">,</span> <span class="o">%</span><span class="n">B</span><span class="p">[</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="o">%</span><span class="n">j</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="gemm">
<h4>GEMM<a class="headerlink" href="#gemm" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;gemm&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.atomic&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                          </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id15">
<h5>Overview<a class="headerlink" href="#id15" title="Link to this heading">#</a></h5>
<p>GEMM implements the well-known GEMM BLAS-3 operation.</p>
<div class="math notranslate nohighlight">
\[C := \alpha \text{op}_1(A) \text{op}_2(B) + \beta C\]</div>
<p>The functions <span class="math notranslate nohighlight">\(\text{op}_1\)</span> and <span class="math notranslate nohighlight">\(\text{op}_2\)</span> are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{op}_i(X) := \left\{
                  \begin{array}{rcl}
                    X^T &amp; \text{ if } &amp; \text{transpose}_i = \text{&quot;.t&quot;},\\
                    X   &amp; \text{ else. }
                  \end{array}
                  \right.\end{split}\]</div>
<p>where transpose<sub>1</sub> and transpose<sub>2</sub> refer to the first and second transpose modifier, respectively.</p>
<p>If the atomic flag is set, C is updated atomically.</p>
</section>
<section id="id16">
<h5>Operands<a class="headerlink" href="#id16" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>memref-type</p></td>
<td><p>B</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>memref-type</p></td>
<td><p>C</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id17">
<h5>Restrictions<a class="headerlink" href="#id17" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(A) = \text{order}(B) = \text{order}(C) = 2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{colums}(\text{op}_1(A)) = \text{rows}(\text{op}_2(B))\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rows}(C) = \text{rows}(\text{op}_1(A))\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{columns}(C) = \text{columns}(\text{op}_2(B))\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\alpha) \preceq \text{promote}(\text{element_type}(A), \text{element_type}(B)) \preceq \text{element_type}(C)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\beta) \preceq \text{element_type}(C)\)</span></p></li>
<li><p>If the atomic flag is set, <span class="math notranslate nohighlight">\(\beta\)</span> must be constant and <span class="math notranslate nohighlight">\(\beta \in \{0,1\}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="gemv">
<h4>GEMV<a class="headerlink" href="#gemv" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;gemv&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.atomic&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                          </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id18">
<h5>Overview<a class="headerlink" href="#id18" title="Link to this heading">#</a></h5>
<p>GEMV implements the well-known GEMM BLAS-2 operation.</p>
<div class="math notranslate nohighlight">
\[c := \alpha \text{op}_1(A) b + \beta c\]</div>
<p>where <span class="math notranslate nohighlight">\(\text{op}_1\)</span> is defined as in GEMM.</p>
<p>If the atomic flag is set, c is updated atomically.</p>
</section>
<section id="id19">
<h5>Operands<a class="headerlink" href="#id19" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>memref-type</p></td>
<td><p>b</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>memref-type</p></td>
<td><p>c</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id20">
<h5>Restrictions<a class="headerlink" href="#id20" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(A) = 2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{order}(b) = \text{order}(c) = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{colums}(\text{op}_1(A)) = \text{rows}(b)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rows}(c) = \text{rows}(\text{op}_1(A))\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\alpha) \preceq \text{promote}(\text{element_type}(A), \text{element_type}(b)) \preceq \text{element_type}(C)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\beta) \preceq \text{element_type}(C)\)</span></p></li>
<li><p>If the atomic flag is set, <span class="math notranslate nohighlight">\(\beta\)</span> must be constant and <span class="math notranslate nohighlight">\(\beta \in \{0,1\}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="ger">
<h4>GER<a class="headerlink" href="#ger" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;ger&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.atomic&quot;</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                         </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id21">
<h5>Overview<a class="headerlink" href="#id21" title="Link to this heading">#</a></h5>
<p>Computes the general rank-1 update:</p>
<div class="math notranslate nohighlight">
\[C := \alpha a b^T + \beta C\]</div>
<p>If the atomic flag is set, C is updated atomically.</p>
</section>
<section id="id22">
<h5>Operands<a class="headerlink" href="#id22" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>a</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>memref-type</p></td>
<td><p>b</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>memref-type</p></td>
<td><p>C</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id23">
<h5>Restrictions<a class="headerlink" href="#id23" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(a) = \text{order}(b) = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{order}(C) = 2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rows}(C) = \text{rows}(a)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{columns}(C) = \text{rows}(b)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\alpha) \preceq \text{promote}(\text{element_type}(A), \text{element_type}(b)) \preceq \text{element_type}(C)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\beta) \preceq \text{element_type}(C)\)</span></p></li>
<li><p>If the atomic flag is set, <span class="math notranslate nohighlight">\(\beta\)</span> must be constant and <span class="math notranslate nohighlight">\(\beta \in \{0,1\}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="hadamard-product">
<h4>Hadamard product<a class="headerlink" href="#hadamard-product" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;hadamard&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.atomic&quot;</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                              </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id24">
<h5>Overview<a class="headerlink" href="#id24" title="Link to this heading">#</a></h5>
<p>Computes the Hadamard product of two vectors or two matrices.
That is, in index notation we have</p>
<div class="math notranslate nohighlight">
\[c_{i} := \alpha a_{i} b_{i} + \beta c_{i}\]</div>
<p>for vectors and</p>
<div class="math notranslate nohighlight">
\[C_{ij} := \alpha A_{ij} B_{ij} + \beta C_{ij}\]</div>
<p>for matrices. If the atomic flag is set, c/C is updated atomically.</p>
</section>
<section id="id25">
<h5>Operands<a class="headerlink" href="#id25" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>a/A</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>memref-type</p></td>
<td><p>b/B</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>memref-type</p></td>
<td><p>c/C</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id26">
<h5>Restrictions<a class="headerlink" href="#id26" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(a) = \text{order}(b) = \text{order}(c) = o\)</span> with <span class="math notranslate nohighlight">\(o\in\{1,2\}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{shape}(a) = \text{shape}(b) = \text{shape}(c)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\alpha) \preceq \text{promote}(\text{element_type}(A), \text{element_type}(b)) \preceq \text{element_type}(C)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\beta) \preceq \text{element_type}(C)\)</span></p></li>
<li><p>If the atomic flag is set, <span class="math notranslate nohighlight">\(\beta\)</span> must be constant and <span class="math notranslate nohighlight">\(\beta \in \{0,1\}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="parallel">
<h4>Parallel<a class="headerlink" href="#parallel" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;parallel&quot;</span><span class="w"> </span><span class="nc">region</span>
</pre></div>
</div>
<section id="id27">
<h5>Overview<a class="headerlink" href="#id27" title="Link to this heading">#</a></h5>
<p>Opens an <em>spmd region</em>.</p>
</section>
</section>
<section id="sum">
<h4>Sum<a class="headerlink" href="#sum" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;sum&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.atomic&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                         </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id28">
<h5>Overview<a class="headerlink" href="#id28" title="Link to this heading">#</a></h5>
<p>Computes the matrix-vector product or the dot product of A with a vector of ones.
That is, if the result is a vector we have</p>
<div class="math notranslate nohighlight">
\[b := \alpha \text{op}(A) \vec{1} + \beta b,\]</div>
<p>where <span class="math notranslate nohighlight">\(\text{op}(A)\)</span> is defined as in the axpby instruction,
and if the result is a scalar we have</p>
<div class="math notranslate nohighlight">
\[b := \alpha \left&lt;A,\vec{1}\right&gt; + \beta b\]</div>
<p>If the atomic flag is set, b is updated atomically.</p>
</section>
<section id="id29">
<h5>Operands<a class="headerlink" href="#id29" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>number-type</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>memref-type</p></td>
<td><p>b</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id30">
<h5>Restrictions<a class="headerlink" href="#id30" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(b) = 1 \lor \text{order}(b) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{order}(A) = \text{order}(b)+1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rows}(b) = \text{rows}(\text{op}(A)) \text{ if } \text{order}(b) = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\alpha) \preceq \text{element_type}(A) \preceq \text{element_type}(B)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(\beta) \preceq \text{element_type}(B)\)</span></p></li>
<li><p>If the atomic flag is set, <span class="math notranslate nohighlight">\(\beta\)</span> must be constant and <span class="math notranslate nohighlight">\(\beta \in \{0,1\}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="additional-instructions">
<h4>Additional instructions<a class="headerlink" href="#additional-instructions" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">             </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;lifetime_stop&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
</section>
</section>
<section id="mixed-instructions">
<h3>Mixed instructions<a class="headerlink" href="#mixed-instructions" title="Link to this heading">#</a></h3>
<section id="arithmetic-binary">
<h4>Arithmetic (binary)<a class="headerlink" href="#arithmetic-binary" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">arith-binary-type</span><span class="w">       </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;add&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;sub&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;mul&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;div&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;rem&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;max&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;min&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;shl&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;shr&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;and&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;or&quot;</span><span class="w">  </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;xor&quot;</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">arith-binary-type</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="w">                           </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="p">(</span><span class="nc">boolean-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">number-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">coopmatrix-type</span><span class="p">)</span>
</pre></div>
</div>
<section id="id31">
<h5>Overview<a class="headerlink" href="#id31" title="Link to this heading">#</a></h5>
<p>Binary arithmetic operation on scalars and cooperative matrices.
Both operands, as well as the returned type, have the same scalar or component type.
Arithmetic on cooperative matrices is done component-wise.</p>
<p>The following table shows the operations’ description and the types that are allowed for the operation.
The backslash “\” is used to exclude types from the list of allowed types.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op</p></th>
<th class="head"><p>Allowed type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>add</p></td>
<td><p>number-type</p></td>
<td><p>Sum of operands</p></td>
</tr>
<tr class="row-odd"><td><p>sub</p></td>
<td><p>number-type</p></td>
<td><p>Difference of operands</p></td>
</tr>
<tr class="row-even"><td><p>mul</p></td>
<td><p>number-type</p></td>
<td><p>Product of operands</p></td>
</tr>
<tr class="row-odd"><td><p>div</p></td>
<td><p>number-type</p></td>
<td><p>Quotient of operands</p></td>
</tr>
<tr class="row-even"><td><p>rem</p></td>
<td><p>number-type \ complex-type</p></td>
<td><p>Remainder from the division of operands</p></td>
</tr>
<tr class="row-odd"><td><p>max</p></td>
<td><p>number-type \ complex-type</p></td>
<td><p>Maximum of operands</p></td>
</tr>
<tr class="row-even"><td><p>min</p></td>
<td><p>number-type \ complex-type</p></td>
<td><p>Minimum of operands</p></td>
</tr>
<tr class="row-odd"><td><p>shl</p></td>
<td><p>integer-type</p></td>
<td><p>Left shift first operand by second operand</p></td>
</tr>
<tr class="row-even"><td><p>shr</p></td>
<td><p>integer-type</p></td>
<td><p>Arithmetic right shift first operand by second operand</p></td>
</tr>
<tr class="row-odd"><td><p>and</p></td>
<td><p>boolean-type / integer-type</p></td>
<td><p>Bitwise and</p></td>
</tr>
<tr class="row-even"><td><p>or</p></td>
<td><p>boolean-type / integer-type</p></td>
<td><p>Bitwise or</p></td>
</tr>
<tr class="row-odd"><td><p>xor</p></td>
<td><p>boolean-type / integer-type</p></td>
<td><p>Bitwise xor</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="arithmetic-unary">
<h4>Arithmetic (unary)<a class="headerlink" href="#arithmetic-unary" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">arith-unary-type</span><span class="w">        </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;abs&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;neg&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;not&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;conj&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;im&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;re&quot;</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">arith-unary-type</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="w">                           </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="p">(</span><span class="nc">number-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">coopmatrix-type</span><span class="p">)</span>
</pre></div>
</div>
<section id="id32">
<h5>Overview<a class="headerlink" href="#id32" title="Link to this heading">#</a></h5>
<p>Unary arithmetic operation on scalars and cooperative matrices.
For integer and floating point input, the operand must have the same type as the returned value.
For complex input, the returned value has the component floating point type
for “.abs”, “.im”, and “.re”, and the returned value has the same type as the operand
for “.neg” and “.conj”.
Arithmetic on cooperative matrices is done component-wise.</p>
<p>The following table shows the operations’ description and the types that are allowed for the operation.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op</p></th>
<th class="head"><p>Allowed type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>abs</p></td>
<td><p>number-type</p></td>
<td><p>Compute absolute value</p></td>
</tr>
<tr class="row-odd"><td><p>neg</p></td>
<td><p>number-type</p></td>
<td><p>Negation</p></td>
</tr>
<tr class="row-even"><td><p>not</p></td>
<td><p>boolean-type / integer-type</p></td>
<td><p>Bitwise not</p></td>
</tr>
<tr class="row-odd"><td><p>conj</p></td>
<td><p>complex-type</p></td>
<td><p>Complex conjugate</p></td>
</tr>
<tr class="row-even"><td><p>im</p></td>
<td><p>complex-type</p></td>
<td><p>Extract imaginary part</p></td>
</tr>
<tr class="row-odd"><td><p>re</p></td>
<td><p>complex-type</p></td>
<td><p>Extract real part</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="associated">
<h4>Associated<a class="headerlink" href="#associated" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w"> </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;associated&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">bool-type</span>
</pre></div>
</div>
<section id="id33">
<h5>Overview<a class="headerlink" href="#id33" title="Link to this heading">#</a></h5>
<p>Checks whether if a memref or group is associated.
Returns true if the base address is non-null.</p>
</section>
<section id="id34">
<h5>Operands<a class="headerlink" href="#id34" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>memref-type / group-type</p></td>
<td><p>tensor</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="returns">
<h5>Returns<a class="headerlink" href="#returns" title="Link to this heading">#</a></h5>
<p>True if the memref is associated and false otherwise, that is, if the base address is a
null pointer.</p>
</section>
</section>
<section id="atomic-load">
<h4>Atomic load<a class="headerlink" href="#atomic-load" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w"> </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;atomic_load&quot;</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">scope</span><span class="p">]</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">semantics</span><span class="p">]</span>
<span class="w">                                   </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">local-identifier-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                                   </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">scalar-type</span>
<span class="nc">scope</span><span class="w">             </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;.cross_device&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;.device&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;.work_group&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;.subgroup&quot;</span>
memory_<span class="nc">semantics</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;.relaxed&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;.acquire&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;.release&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;.acquire_release&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;.sequentially_consistent&quot;</span>
</pre></div>
</div>
<section id="id35">
<h5>Overview<a class="headerlink" href="#id35" title="Link to this heading">#</a></h5>
<p>Load the element given by the index list from a memref atomically.
The number of indices must match the order of the memref
and a single index must be given for a group.</p>
<p>The store is atomic and the default scope is “work_group” and the default memory semantics is “relaxed”.</p>
</section>
<section id="id36">
<h5>Operands<a class="headerlink" href="#id36" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>memref-type / group-type</p></td>
<td><p>tensor</p></td>
</tr>
<tr class="row-odd"><td><p>2…</p></td>
<td><p>index</p></td>
<td><p>index list</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id37">
<h5>Returns<a class="headerlink" href="#id37" title="Link to this heading">#</a></h5>
<p>A value of the memref’s element type.</p>
</section>
</section>
<section id="atomic-store">
<h4>Atomic store<a class="headerlink" href="#atomic-store" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;atomic_store&quot;</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">scope</span><span class="p">]</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">semantics</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                                  </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">local-identifier-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
</pre></div>
</div>
<section id="id38">
<h5>Overview<a class="headerlink" href="#id38" title="Link to this heading">#</a></h5>
<p>Store a scalar value (first operand) in a memref (second operand) at the position given by the index list.
The number of indices must match the order of the memref.</p>
<p>The store is atomic and the default scope is “work_group” and the default memory semantics is “relaxed”.</p>
<p>When storing a complex value the update may be pseudo-atomic, meaning that an atomic store is used
for the the real and imaginary separately.</p>
</section>
<section id="id39">
<h5>Operands<a class="headerlink" href="#id39" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p>value</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>tensor</p></td>
</tr>
<tr class="row-even"><td><p>3…</p></td>
<td><p>index</p></td>
<td><p>index list</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id40">
<h5>Restrictions<a class="headerlink" href="#id40" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{type}(value) = \text{element_type}(tensor)\)</span></p></li>
</ul>
</section>
</section>
<section id="atomic-update">
<h4>Atomic update<a class="headerlink" href="#atomic-update" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">atomic-update-op</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;atomic_add&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;atomic_min&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                     </span><span class="l">&quot;atomic_max&quot;</span>
<span class="nc">value-instruction</span><span class="w"> </span><span class="o">=/</span><span class="w"> </span><span class="nc">atomic-update-scope</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">scope</span><span class="p">]</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">semantics</span><span class="p">]</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                                         </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">local-identifier-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                                         </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">number-type</span>
</pre></div>
</div>
<section id="id41">
<h5>Overview<a class="headerlink" href="#id41" title="Link to this heading">#</a></h5>
<p>Store a scalar value (first operand) in a memref (second operand) at the position given by the index list.
The number of indices must match the order of the memref, and the return type must match the memref’s
element type.</p>
<p>The following steps are done atomically:
The value at the memory location is fetched, the fetched value is updated with the fetched value,
and the resulting value is stored at the memory location.
The default scope is “work_group” and the default memory semantics is “relaxed”.</p>
<p>When storing a complex value the update may be pseudo-atomic, meaning that an atomic update is used
for the the real and imaginary separately.</p>
</section>
<section id="id42">
<h5>Operands<a class="headerlink" href="#id42" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p>value</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>tensor</p></td>
</tr>
<tr class="row-even"><td><p>3…</p></td>
<td><p>index</p></td>
<td><p>index list</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id43">
<h5>Restrictions<a class="headerlink" href="#id43" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{type}(value) = \text{element_type}(tensor)\)</span></p></li>
</ul>
</section>
</section>
<section id="barrier">
<h4>Barrier<a class="headerlink" href="#barrier" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">             </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;barrier&quot;</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.global&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;.local&quot;</span><span class="p">]</span>
</pre></div>
</div>
<section id="id44">
<h5>Overview<a class="headerlink" href="#id44" title="Link to this heading">#</a></h5>
<p><strong>Note:</strong> Barriers are inserted automatically in collective regions, but not in SPMD regions.
Manual barrier insertion should only be only necessesary in SPMD regions.</p>
<p>Control barrier.
The barrier must be encountered by all work-items.
A work-item in a work-group is not allowed to continue until all work-items in the work-group
have reached the barrier.</p>
<p>Aditional memory fences are controlled by the following attributes:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.global</p></td>
<td><p>Ensure that global memory accesses become visible to the work-group.</p></td>
</tr>
<tr class="row-odd"><td><p>.local</p></td>
<td><p>Ensure that local memory accesses become visible to the work-group.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="builtin-mixed">
<h4>Builtin (mixed)<a class="headerlink" href="#builtin-mixed" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">mixed-builtin-type</span><span class="w">      </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;group_id&quot;</span><span class="w"> </span><span class="nc">comp3</span><span class="w">      </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;num_groups&quot;</span><span class="w"> </span><span class="nc">comp3</span><span class="w">    </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;num_subgroups&quot;</span><span class="w"> </span><span class="nc">comp3</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;subgroup_size&quot;</span>
<span class="nc">comp3</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;.x&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;.y&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;.z&quot;</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">mixed-builtin-type</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">integer-type</span>
</pre></div>
</div>
<section id="id45">
<h5>Overview<a class="headerlink" href="#id45" title="Link to this heading">#</a></h5>
<p>Returns a builtin value.</p>
<p>The group id is three dimensional; the mode is selected with the .x, .y, and .z suffix.
Each mode starts with zero and is limited by the corresponding num_groups mode. That is,</p>
<div class="math notranslate nohighlight">
\[\forall d \in \{x,y,z\} : 0 \leq \text{group_id}_d &lt; \text{num_groups}_d\]</div>
<p>The number of subgroups is related to the 2-dimensional work-group size as following:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\text{num_subgroups}_x &amp;= \frac{\text{work_group_size[0]}}{\text{subgroup_size}} \\
\text{num_subgroups}_y &amp;= \text{work_group_size[1]} \\
\text{num_subgroups}_z &amp;= 1
\end{aligned}\end{split}\]</div>
<p>The following table shows the builtins’ description and the types that are returned.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Builtin</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>OpenCL analogue</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>group_id</p></td>
<td><p>index</p></td>
<td><p>get_group_id</p></td>
<td><p>Returns the x, y, or z mode of the group id</p></td>
</tr>
<tr class="row-odd"><td><p>num_groups</p></td>
<td><p>index</p></td>
<td><p>get_num_groups</p></td>
<td><p>Returns number of groups in the x, y, or z mode</p></td>
</tr>
<tr class="row-even"><td><p>num_subgroups</p></td>
<td><p>i32</p></td>
<td><p>N/A</p></td>
<td><p>Returns the number of subgroups in the x, y, or z mode</p></td>
</tr>
<tr class="row-odd"><td><p>subgroup_size</p></td>
<td><p>i32</p></td>
<td><p>get_max_sub_group_size</p></td>
<td><p>Returns the subgroup size</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="cast">
<h4>Cast<a class="headerlink" href="#cast" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cast&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">number-type</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cast&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id46">
<h5>Overview<a class="headerlink" href="#id46" title="Link to this heading">#</a></h5>
<p>Cast scalar values or cooperative matrices to type indicated after the colon.</p>
<p>The source type must be a coopmatrix type if the destination type is a coopmatrix type,
and the shapes must match.
The coopmatrix use must either match, or
the use of the source type must be matrix_acc and the use of the destination type
must be matrix_a or matrix_b.</p>
<p>Casts from complex types to non-complex types are forbidden.
The following table summarizes the casts and the mapping to SPIR-V
(the casts are done component-wise for coopmatrix types):</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Operand type</p></th>
<th class="head"><p>Result type</p></th>
<th class="head"><p>SPIR-V Op</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer-type</p></td>
<td><p>integer-type</p></td>
<td><p>OpSConvert</p></td>
</tr>
<tr class="row-odd"><td><p>floating-type</p></td>
<td><p>floating-type</p></td>
<td><p>OpFConvert</p></td>
</tr>
<tr class="row-even"><td><p>complex-type</p></td>
<td><p>complex-type</p></td>
<td><p>OpFConvert (on vector2)</p></td>
</tr>
<tr class="row-odd"><td><p>integer-type</p></td>
<td><p>floating-type</p></td>
<td><p>OpConvertSToF</p></td>
</tr>
<tr class="row-even"><td><p>floating-type</p></td>
<td><p>integer-type</p></td>
<td><p>OpConvertFToS</p></td>
</tr>
<tr class="row-odd"><td><p>floating-type</p></td>
<td><p>complex-type</p></td>
<td><p>OpFConvert on real part, imaginary part is zero</p></td>
</tr>
<tr class="row-even"><td><p>integer-type</p></td>
<td><p>complex-type</p></td>
<td><p>OpConvertSToF on real part, imaginary part is zero</p></td>
</tr>
<tr class="row-odd"><td><p>complex-type</p></td>
<td><p>integer-type</p></td>
<td><p>Forbidden</p></td>
</tr>
<tr class="row-even"><td><p>complex-type</p></td>
<td><p>floating-type</p></td>
<td><p>Forbidden</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="comparison">
<h4>Comparison<a class="headerlink" href="#comparison" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">comparison-type</span><span class="w">         </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;equal&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;not_equal&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;greater_than&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;greater_than_equal&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;less_than&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;less_than_equal&quot;</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">comparison-type</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="l">&quot;bool&quot;</span>
</pre></div>
</div>
<section id="id47">
<h5>Overview<a class="headerlink" href="#id47" title="Link to this heading">#</a></h5>
<p>Scalar comparison.
Both operands must have the same scalar type and the returned value has boolean type.</p>
<p>The following table shows the comparisons’ description and the types that are allowed for the comparison.
The backslash “\” is used to exclude types from the list of allowed types.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Cond</p></th>
<th class="head"><p>Allowed type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>equal</p></td>
<td><p>number-type</p></td>
<td><p>Equal</p></td>
</tr>
<tr class="row-odd"><td><p>not_equal</p></td>
<td><p>number-type</p></td>
<td><p>Not equal</p></td>
</tr>
<tr class="row-even"><td><p>greater_than</p></td>
<td><p>number-type \ complex-type</p></td>
<td><p>Greater than</p></td>
</tr>
<tr class="row-odd"><td><p>greather_than_equal</p></td>
<td><p>number-type \ complex-type</p></td>
<td><p>Greater than or equal</p></td>
</tr>
<tr class="row-even"><td><p>less_than</p></td>
<td><p>number-type \ complex-type</p></td>
<td><p>Less than</p></td>
</tr>
<tr class="row-odd"><td><p>less_than_equal</p></td>
<td><p>number-type \ complex-type</p></td>
<td><p>Less than or equal</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="constant">
<h4>Constant<a class="headerlink" href="#constant" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;constant&quot;</span><span class="w"> </span><span class="nc">constant</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="p">(</span><span class="nc">boolean-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">number-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">coopmatrix-type</span><span class="p">)</span>
</pre></div>
</div>
<section id="id48">
<h5>Overview<a class="headerlink" href="#id48" title="Link to this heading">#</a></h5>
<p>Sets the result value to a constant value.
The type of the constant must match the scalar or component type
(e.g. an integer type requires an integer-constant and a floating type requires a floating-constant).</p>
<p>When the result is a cooperative matrix, all entries are set to the same constant value.</p>
</section>
</section>
<section id="expand">
<h4>Expand<a class="headerlink" href="#expand" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;expand&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;-&gt;&quot;</span><span class="w"> </span><span class="nc">expand-shape</span><span class="w"> </span><span class="l">&quot;]&quot;</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">memref-type</span>
<span class="nc">expand-shape</span><span class="w">            </span><span class="o">=</span><span class="w">  </span><span class="nc">integer-constant-or-identifier</span><span class="w"> </span><span class="o">1*</span><span class="p">(</span><span class="l">&quot;x&quot;</span><span class="w"> </span><span class="nc">integer-constant-or-identifier</span><span class="p">)</span>
<span class="nc">integer-constant-or-identifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">local-identifier</span>
</pre></div>
</div>
<section id="id49">
<h5>Overview<a class="headerlink" href="#id49" title="Link to this heading">#</a></h5>
<p>The expand instruction returns a view on a tensor with a mode viewed as higher-order mode.</p>
</section>
<section id="id50">
<h5>Operands<a class="headerlink" href="#id50" title="Link to this heading">#</a></h5>
<p>The first argument must point to a value of memref type.
The first integer constant before “-&gt;” gives the mode that shall be expanded.
The expand shape coming after “-&gt;” gives the new shape of the mode.
Dynamic values in the expand shape must have <cite>index</cite> type.</p>
</section>
<section id="id51">
<h5>Restrictions<a class="headerlink" href="#id51" title="Link to this heading">#</a></h5>
<p>The memref type of the result must conform with the following rules:</p>
<ol class="arabic">
<li><p>Element type and address space must match the operand’s memref type.</p></li>
<li><p><strong>Shape:</strong> The mode size is replaced with the expand shape.
The product of the expand shape must equal the size of the expanded mode.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expand</span> <span class="o">%</span><span class="mi">0</span><span class="p">[</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="n">x8</span><span class="p">]</span>      <span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x32x2x8x8</span><span class="o">&gt;</span>     <span class="p">;</span> <span class="o">%</span><span class="mi">0</span><span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x32x16x8</span><span class="o">&gt;</span>
<span class="n">expand</span> <span class="o">%</span><span class="mi">0</span><span class="p">[</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>  <span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x32x2x2x2x2x8</span><span class="o">&gt;</span> <span class="p">;</span> <span class="o">%</span><span class="mi">0</span><span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x32x16x8</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p><strong>Identifiers:</strong> Local identifiers in the expand shape are dynamic in the resulting memref type.
The product of the dynamic expand shape must equal the size of the expanded mode.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>expand %0[1 -&gt; %1 x 2]      : memref&lt;f32x32x?x2&gt;   ; %0: memref&lt;f32x32x?&gt;
expand %0[1 -&gt; 2 x %1]      : memref&lt;f32x32x2x?&gt;   ; %0: memref&lt;f32x32x?&gt;
expand %0[1 -&gt; %1 x 2]      : memref&lt;f32x32x?x2&gt;   ; %0: memref&lt;f32x32x16&gt;
expand %0[1 -&gt; %1 x 2]      : memref&lt;f32x32x?x2&gt;   ; %0: memref&lt;f32x32x?&gt;
expand %0[1 -&gt; %1 x %2 x 2] : memref&lt;f32x32x?x?x2&gt; ; %0: memref&lt;f32x32x16&gt;
expand %0[1 -&gt; %2 x 2 x %1] : memref&lt;f32x32x?x2x?&gt; ; %0: memref&lt;f32x32x16&gt;
expand %0[1 -&gt; %1 x %2]     : memref&lt;f32x32x?x?&gt;   ; %0: memref&lt;f32x32x?&gt;
expand %0[1 -&gt; %1 x %2]     : memref&lt;f32x32x?x?&gt;   ; %0: memref&lt;f32x32x16&gt;
</pre></div>
</div>
<p><em>Note:</em> In the third example above, %1 must be equal to 8.
The output mode corresponding to %1 is still dynamic.</p>
</li>
<li><p><strong>Stride:</strong> A new stride entry is entered that follows the canonical stride computation.
It is also permissible to put ‘?’ for a stride instead of the constant value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>expand %0[0-&gt;4 x 8]  : memref&lt;f32x4x8x7,strided&lt;2,8,64&gt;&gt; ; %0: memref&lt;f32x32x7,strided&lt;2,64&gt;&gt;
expand %0[0-&gt;4 x 8]  : memref&lt;f32x4x8x7,strided&lt;2,?,?&gt;&gt;  ; %0: memref&lt;f32x32x7,strided&lt;2,64&gt;&gt;
expand %0[0-&gt;%1 x 4] : memref&lt;f32x?x4x7,strided&lt;2,?,?&gt;&gt;  ; %0: memref&lt;f32x?x7,strided&lt;2,?&gt;&gt;
expand %0[0-&gt;4 x %1] : memref&lt;f32x4x?x7,strided&lt;2,8,?&gt;&gt;  ; %0: memref&lt;f32x?x7,strided&lt;2,?&gt;&gt;
expand %0[0-&gt;4 x %1] : memref&lt;f32x4x?x7,strided&lt;2,?,?&gt;&gt;  ; %0: memref&lt;f32x?x7,strided&lt;2,?&gt;&gt;
</pre></div>
</div>
</li>
</ol>
<p>Further restrictions:</p>
<ul class="simple">
<li><p>The product of the expand shape must be the same as the mode size.</p></li>
<li><p>If the product of the expand shape is only known at runtime, then it is undefined behaviour
if the dynamic product does not match the mode size.</p></li>
</ul>
</section>
</section>
<section id="for">
<h4>For<a class="headerlink" href="#for" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">multi-value-instruction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;for&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;=&quot;</span>
<span class="w">                                </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="p">]</span>
<span class="w">                          </span><span class="p">[</span><span class="l">&quot;init&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">init-value-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="l">&quot;-&gt;&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">return-type-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="nc">region</span>
<span class="w">                          </span><span class="p">[</span><span class="l">&quot;attributes&quot;</span><span class="w"> </span><span class="nc">dictionary-attribute</span><span class="p">]</span>
<span class="nc">init-value-list</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nc">init-value</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">init-value</span><span class="p">)</span>
<span class="nc">init-value</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;=&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="nc">return-type-list</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nc">return-type</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">return-type</span><span class="p">)</span>
<span class="nc">return-type</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nc">boolean-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">number-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id52">
<h5>Overview<a class="headerlink" href="#id52" title="Link to this heading">#</a></h5>
<p>A for loop.
Instructions in the for loop execute sequentially and its region is a <em>mixed region</em>.</p>
</section>
<section id="arguments">
<h5>Arguments<a class="headerlink" href="#arguments" title="Link to this heading">#</a></h5>
<p>The trip count is stored in the first local identifier and is accessible within the loop body.
The loop’s range [from; to) is given by the first and the second local identifier after the equals sign,
and a step size may be given with the third local identifier after the equals sign.
The step size defaults to 1 if omitted.
The integer type of “from”, “to”, and “step” must be identical, and the integer type of the loop variable
follows the loop range’s type.</p>
<p>Values that are given in the init-value-list may be carried from one iteration to the next.
The local identifier gives the name of the loop-carried value as it is accessible in the loop body.
The local identifier given on the right-hand side of the init-value expression determines
the initial value of the loop-carried value, and its type must coincide with the number-type-list.
When loop-carried values are present, the loop’s last instruction must be a yield instruction that
updates the loop-carried values for the next iteration.
The number and types of the yielded values must correspond the number-type-list.</p>
</section>
<section id="id53">
<h5>Returns<a class="headerlink" href="#id53" title="Link to this heading">#</a></h5>
<p>The final value of the loop-carried values are returned by the for instruction.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="kn">from</span><span class="w"> </span><span class="o">=</span> <span class="n">constant</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">i32</span>
<span class="o">%</span><span class="n">to</span> <span class="o">=</span> <span class="n">constant</span> <span class="mi">6</span> <span class="p">:</span> <span class="n">i32</span>
<span class="o">%</span><span class="n">f0</span> <span class="o">=</span> <span class="n">constant</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">i64</span>
<span class="o">%</span><span class="n">f1</span> <span class="o">=</span> <span class="n">constant</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">i64</span>
<span class="o">%</span><span class="n">fn_1</span><span class="p">,</span> <span class="o">%</span><span class="n">fn</span> <span class="o">=</span> <span class="k">for</span> <span class="o">%</span><span class="n">n</span><span class="o">=%</span><span class="n">from</span><span class="p">,</span><span class="o">%</span><span class="n">to</span> <span class="n">init</span><span class="p">(</span><span class="o">%</span><span class="n">fn_2</span><span class="o">=%</span><span class="n">f0</span><span class="p">,</span><span class="o">%</span><span class="n">fn_1</span><span class="o">=%</span><span class="n">f1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">i64</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">%</span><span class="n">fn</span> <span class="o">=</span> <span class="n">add</span> <span class="o">%</span><span class="n">fn_2</span><span class="p">,</span> <span class="o">%</span><span class="n">fn_1</span> <span class="p">:</span> <span class="n">i64</span>
    <span class="k">yield</span> <span class="p">(</span><span class="o">%</span><span class="n">fn_1</span><span class="p">,</span> <span class="o">%</span><span class="n">fn</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">;</span> <span class="o">%</span><span class="n">fn_1</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">fourth</span> <span class="n">Fibonacci</span> <span class="n">number</span> <span class="ow">and</span> <span class="o">%</span><span class="n">fn</span> <span class="n">the</span> <span class="n">fifth</span> <span class="n">Fibonacci</span> <span class="n">number</span>
</pre></div>
</div>
</section>
<section id="id54">
<h5>Attributes<a class="headerlink" href="#id54" title="Link to this heading">#</a></h5>
<p>The following named attributes may be passed in the attribute dictionary:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Type</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>unroll</p></td>
<td><p>boolean-attribute or integer-attribute</p></td>
<td><p>true: request to unroll loop, false: request to not unroll loop, integer: partial unroll count</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="fuse">
<h4>Fuse<a class="headerlink" href="#fuse" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;fuse&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                                  </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">memref-type</span>
</pre></div>
</div>
<section id="id55">
<h5>Overview<a class="headerlink" href="#id55" title="Link to this heading">#</a></h5>
<p>The fuse instruction returns a view on a tensor with two or more adjacent modes viewed as a single mode.</p>
<p>Fused modes are specified as the interval [from, to], where counting starts from 0.
From and to must refer to existing modes, that is, we require <span class="math notranslate nohighlight">\(0 \leq \text{from} &lt; \text{to} &lt; \text{order}(\text{tensor})\)</span>.
Moreover, the stride vector S and the shape vector s must satisify the following compatibility condition:</p>
<p><span class="math notranslate nohighlight">\(\forall k \in [\text{from},\text{to}): S_{k}s_{k} = S_{k+1}\)</span></p>
<p>If S(i:j) and s(i:j) are known at compile time, the fuse instruction is illegal if the compatibility
condition is not satisfied.
If a single entry in S(i:j) or s(i:j) is dynamic, then fusing modes that violate the compatbility condition
is undefined beheaviour, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>; Illegal, modes cannot be fused
fuse %0[0,1] : memref&lt;f32x128&gt;              ; %0: memref&lt;f32x8x16,strided&lt;1,10&gt;&gt;
; Undefined behaviour if dynamic stride != 8
fuse %0[0,1] : memref&lt;f32x128,strided&lt;1,?&gt;&gt; ; %0: memref&lt;f32x8x16,strided&lt;1,?&gt;&gt;
</pre></div>
</div>
</section>
<section id="id56">
<h5>Operands<a class="headerlink" href="#id56" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>memref-type</p></td>
<td><p>tensor</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>integer-constant</p></td>
<td><p>from</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>integer-constant</p></td>
<td><p>to</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id57">
<h5>Restrictions<a class="headerlink" href="#id57" title="Link to this heading">#</a></h5>
<p>The memref type of the result must conform with the following rules:</p>
<ol class="arabic">
<li><p>Element type and address space must match the operand’s memref type.</p></li>
<li><p><strong>Shape:</strong> The mode size of the fused modes is the product of the mode sizes. If one mode is dynamic the fused mode size is dynamic.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>fuse %0[1,3] : memref&lt;f32x32x512x42&gt;               ; %0: memref&lt;f32x32x16x8x4x42&gt;
fuse %0[1,3] : memref&lt;f32x32x?x42,strided&lt;1,32,?&gt;&gt; ; %0: memref&lt;f32x32x16x?x4x42,strided&lt;1,16,?,?,?&gt;&gt;
</pre></div>
</div>
</li>
<li><p><strong>Stride:</strong> Strides remain unchanged or are replaced by ‘?’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>fuse %0[1,2] : memref&lt;f32x32x32x2,strided&lt;1,48,1536&gt;&gt; ; %0: memref&lt;f32x32x16x2x2,strided&lt;1,48,768,1536&gt;&gt;
fuse %0[1,2] : memref&lt;f32x32x32x2,strided&lt;1,?,?&gt;&gt;     ; %0: memref&lt;f32x32x16x2x2,strided&lt;1,48,768,1536&gt;&gt;
fuse %0[0,1] : memref&lt;f32x?x32,strided&lt;1,?&gt;&gt;          ; %0: memref&lt;f32x8x?x32,strided&lt;1,?,?&gt;&gt;
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="if">
<h4>If<a class="headerlink" href="#if" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">multi-value-instruction</span><span class="w"> </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;if&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;-&gt;&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">return-type-list</span><span class="w"> </span><span class="l">&quot;)&quot;</span><span class="p">]</span>
<span class="w">                           </span><span class="nc">region</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;else&quot;</span><span class="w"> </span><span class="nc">region</span><span class="p">]</span>
</pre></div>
</div>
<section id="id58">
<h5>Overview<a class="headerlink" href="#id58" title="Link to this heading">#</a></h5>
<p>An if statement.
Both regions are <em>mixed regions</em>.</p>
<p>The condition (first operand) must have boolean type.</p>
</section>
<section id="id59">
<h5>Returns<a class="headerlink" href="#id59" title="Link to this heading">#</a></h5>
<p>The if instruction may return multiple values, where the number of values and the value types
are given by the return-type-list.
If values are returned, the last instruction in both the “then”-region and the “else”-region must
be a yield instruction (the “else”-region cannot be omitted).</p>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="mi">1</span> <span class="o">=</span> <span class="n">cmp</span><span class="o">.</span><span class="n">lt</span> <span class="o">%</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span> <span class="p">:</span> <span class="n">i32</span>
<span class="o">%</span><span class="n">x</span> <span class="o">=</span> <span class="k">if</span> <span class="o">%</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">i32</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">yield</span> <span class="p">(</span><span class="o">%</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="o">%</span><span class="n">c16</span> <span class="o">=</span> <span class="n">constant</span> <span class="mi">16</span> <span class="p">:</span> <span class="n">i32</span>
    <span class="k">yield</span> <span class="p">(</span><span class="o">%</span><span class="n">c16</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="load">
<h4>Load<a class="headerlink" href="#load" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">           </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;load&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">local-identifier-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                                      </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">scalar-or-memref-type</span>
<span class="nc">scalar-or-memref-type</span><span class="w">       </span><span class="o">=</span><span class="w">  </span><span class="nc">number-type</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nc">memref-type</span>
</pre></div>
</div>
<section id="id60">
<h5>Overview<a class="headerlink" href="#id60" title="Link to this heading">#</a></h5>
<p>Load the element given by the index list from a memref or group.
The number of indices must match the order of the memref
and a single index must be given for a group.</p>
</section>
<section id="id61">
<h5>Operands<a class="headerlink" href="#id61" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>memref-type / group-type</p></td>
<td><p>tensor</p></td>
</tr>
<tr class="row-odd"><td><p>2…</p></td>
<td><p>index</p></td>
<td><p>index list</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id62">
<h5>Returns<a class="headerlink" href="#id62" title="Link to this heading">#</a></h5>
<p>A value of the memref’s element type or the group’s memref type.
Examples:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">load</span> <span class="pre">%0[]</span> <span class="pre">:</span> <span class="pre">f32</span> <span class="pre">;</span> <span class="pre">%0:</span> <span class="pre">memref&lt;f32&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load</span> <span class="pre">%0[5,</span> <span class="pre">%1]</span> <span class="pre">:</span> <span class="pre">f32</span> <span class="pre">;</span> <span class="pre">%0:</span> <span class="pre">memref&lt;f32x10x?&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load</span> <span class="pre">%0[%1]</span> <span class="pre">:</span> <span class="pre">memref&lt;f32x42&gt;</span> <span class="pre">;</span> <span class="pre">%0:</span> <span class="pre">group&lt;memref&lt;f32x42&gt;x?&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load</span> <span class="pre">%0[%1]</span> <span class="pre">:</span> <span class="pre">memref&lt;f32x42&gt;</span> <span class="pre">;</span> <span class="pre">%0:</span> <span class="pre">group&lt;memref&lt;f32x42&gt;x?,</span> <span class="pre">offset:</span> <span class="pre">?&gt;</span></code></p></li>
</ol>
</section>
</section>
<section id="math-unary">
<h4>Math (unary)<a class="headerlink" href="#math-unary" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">math-unary-type</span><span class="w">         </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;cos&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;sin&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;exp&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;exp2&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;log&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;log2&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;native_cos&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;native_sin&quot;</span>
<span class="w">                           </span><span class="l">&quot;native_exp&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;native_exp2&quot;</span>
<span class="w">                           </span><span class="l">&quot;native_log&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;native_log2&quot;</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">math-unary-type</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">number-type</span>
</pre></div>
</div>
<section id="id63">
<h5>Overview<a class="headerlink" href="#id63" title="Link to this heading">#</a></h5>
<p>Unary math operation on scalars.
The operand must have the same type as the returned value.</p>
<p>The following table shows the operations’ description and the types that are allowed for the operation.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op</p></th>
<th class="head"><p>Allowed type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cos</p></td>
<td><p>floating-type</p></td>
<td><p>Compute cosine function</p></td>
</tr>
<tr class="row-odd"><td><p>sin</p></td>
<td><p>floating-type</p></td>
<td><p>Compute sine function</p></td>
</tr>
<tr class="row-even"><td><p>exp</p></td>
<td><p>floating-type / complex-type</p></td>
<td><p>Compute base-e exponential function</p></td>
</tr>
<tr class="row-odd"><td><p>exp2</p></td>
<td><p>floating-type / complex-type</p></td>
<td><p>Compute base-2 exponential function</p></td>
</tr>
<tr class="row-even"><td><p>log</p></td>
<td><p>floating-type</p></td>
<td><p>Compute base-e logarithm function</p></td>
</tr>
<tr class="row-odd"><td><p>log2</p></td>
<td><p>floating-type</p></td>
<td><p>Compute base-2 logarithm function</p></td>
</tr>
<tr class="row-even"><td><p>native_cos</p></td>
<td><p>floating-type</p></td>
<td><p>Compute cosine function with implementation-defined error</p></td>
</tr>
<tr class="row-odd"><td><p>native_sin</p></td>
<td><p>floating-type</p></td>
<td><p>Compute sine function with implementation-defined error</p></td>
</tr>
<tr class="row-even"><td><p>native_exp</p></td>
<td><p>floating-type / complex-type</p></td>
<td><p>Compute base-e exponential function with implementation-defined error</p></td>
</tr>
<tr class="row-odd"><td><p>native_exp2</p></td>
<td><p>floating-type / complex-type</p></td>
<td><p>Compute base-2 exponential function with implementation-defined error</p></td>
</tr>
<tr class="row-even"><td><p>native_log</p></td>
<td><p>floating-type</p></td>
<td><p>Compute base-e logarithm function with implementation-defined error</p></td>
</tr>
<tr class="row-odd"><td><p>native_log2</p></td>
<td><p>floating-type</p></td>
<td><p>Compute base-2 logarithm function with implementation-defined error</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="size">
<span id="size-instruction"></span><h4>Size<a class="headerlink" href="#size" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;size&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;]&quot;</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="l">&quot;index&quot;</span>
</pre></div>
</div>
<section id="id64">
<h5>Overview<a class="headerlink" href="#id64" title="Link to this heading">#</a></h5>
<p>The size instruction returns the i-th entry of the tensor’s shape, where “i” is given by the integer
constant in square brackets.
“i” must be in bounds, i.e. <span class="math notranslate nohighlight">\(0 \leq i &lt; \text{order}(tensor)\)</span>.</p>
<p>For group types, the group size is returned and “i” must be 0.</p>
</section>
<section id="id65">
<h5>Operands<a class="headerlink" href="#id65" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>memref-type / group-type</p></td>
<td><p>tensor</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>integer-constant</p></td>
<td><p>mode index</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="subview">
<h4>Subview<a class="headerlink" href="#subview" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;subview&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">index-or-slice-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                                     </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">memref-type</span>
<span class="nc">index-or-slice-list</span><span class="w">     </span><span class="o">=</span><span class="w">  </span><span class="nc">index-or-slice</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">index-or-slice</span><span class="p">)</span>
<span class="nc">index-or-slice</span><span class="w">          </span><span class="o">=</span><span class="w">  </span><span class="nc">integer-constant-or-identifier</span><span class="w"> </span><span class="p">[</span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">integer-constant-or-identifier</span><span class="p">]</span>
</pre></div>
</div>
<section id="id66">
<h5>Overview<a class="headerlink" href="#id66" title="Link to this heading">#</a></h5>
<p>The subview instruction returns a view on a tensor.</p>
<p>The first argument must point to a value of memref type.
The number of indices in square brackets must match the order of the memref type.
The indices are either given as single index or as a slice, where
slices are given in offset plus size notation (“%offset : %size”).
E.g. the slice “%0 : %1” extracts a block of %1 elements beginning from %0, which is equivalent
to the index interval [%0, %0 + %1).</p>
<div class="admonition-note admonition">
<p class="admonition-title">Note</p>
<p>A slice is often defined as “%0 : %1” being the index interval [%0, %1).
However, then the compiler needs to figure out whether %1 - %0 is constant or not in order
to determine whether the mode size is known at compile-time or not.
Therefore, we prefer the offset plus size notation.</p>
</div>
<p>Zero sizes are used to encode that a rank-reduction is required, that is,
the rank of size 0 is removed from the output memref type.
A single index is syntactic sugar for offset plus size 0, e.g. %0 is syntactic sugar for %0:0.
(Note that a zero-size rank, e.g. in memref&lt;f32x8x0&gt;, is non-sense, because any multi-index passed
to the memref would be out-of-bounds. However, a one-sized rank, e.g. memref&lt;f32x8x1&gt;, might be desirable.)
A dynamic size of zero is undefined behaviour.</p>
<p>There is no run-time check whether the indices are within bounds.
Offset and size must be of index type.
Offset must be non-negative and size must be positive.</p>
</section>
<section id="id67">
<h5>Restrictions<a class="headerlink" href="#id67" title="Link to this heading">#</a></h5>
<p>The memref type of the result must conform with the following rules:</p>
<ol class="arabic">
<li><p>Element type and address space must match the operand’s memref type.</p></li>
<li><p><strong>Invariant-stride:</strong> The stride is not changed or replaced with ‘?’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>subview %0[4:8,8:4]  : memref&lt;f32x8x4,strided&lt;1,32&gt;&gt; ; %0: memref&lt;f32x32x16&gt;
subview %0[4:8,8:4]  : memref&lt;f32x8x4,strided&lt;1,?&gt;&gt;  ; %0: memref&lt;f32x32x16&gt;
</pre></div>
</div>
</li>
<li><p><strong>Rank-reduction:</strong> A mode accessed by offset only or a mode with size statically known to be 0 is removed from the output tensor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subview</span> <span class="o">%</span><span class="mi">0</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="o">%</span><span class="mi">1</span><span class="p">]</span>   <span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x4</span><span class="o">&gt;</span>                 <span class="p">;</span> <span class="o">%</span><span class="mi">0</span><span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x16x8</span><span class="o">&gt;</span>
<span class="n">subview</span> <span class="o">%</span><span class="mi">0</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="o">%</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x4</span><span class="o">&gt;</span>                 <span class="p">;</span> <span class="o">%</span><span class="mi">0</span><span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f32x16x8</span><span class="o">&gt;</span>
<span class="n">subview</span> <span class="o">%</span><span class="mi">0</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="o">%</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f64x4x1</span><span class="p">,</span><span class="n">strided</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="o">&gt;&gt;</span> <span class="p">;</span> <span class="o">%</span><span class="mi">0</span><span class="p">:</span> <span class="n">memref</span><span class="o">&lt;</span><span class="n">f64x16x8</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p><strong>Output-mode size:</strong> The size of the output mode is determined by the size field of a slice
and may be dynamic.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>subview %0[%1:4]            : memref&lt;f32x4&gt;                      ; %0: memref&lt;f32x16&gt;
subview %0[%2:%2]           : memref&lt;f32x?&gt;                      ; %0: memref&lt;f32x16&gt;
subview %0[2:4, %2:%2, 6:7] : memref&lt;f32x4x?x7,strided&lt;1,16,672&gt; ; %0: memref&lt;f32x16x42x13&gt;
subview %0[2:4, %2:%2, 6:7] : memref&lt;f32x4x?x7,strided&lt;1,?,?&gt;    ; %0: memref&lt;f32x16x42x13,strided&lt;1,?,?&gt;&gt;
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="store">
<h4>Store<a class="headerlink" href="#store" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;store&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                           </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">local-identifier-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
</pre></div>
</div>
<section id="id68">
<h5>Overview<a class="headerlink" href="#id68" title="Link to this heading">#</a></h5>
<p>Store a scalar value (first operand) in a memref (second operand) at the position given by the index list.
The number of indices must match the order of the memref.</p>
<p><em>Note:</em> Store should only be used in SPMD regions as otherwise the same memory location is written
from all work-items.</p>
</section>
<section id="id69">
<h5>Operands<a class="headerlink" href="#id69" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p>value</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>tensor</p></td>
</tr>
<tr class="row-even"><td><p>3…</p></td>
<td><p>index</p></td>
<td><p>index list</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id70">
<h5>Restrictions<a class="headerlink" href="#id70" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{type}(value) = \text{element_type}(tensor)\)</span></p></li>
</ul>
</section>
</section>
<section id="yield">
<h4>Yield<a class="headerlink" href="#yield" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">                 </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;yield&quot;</span><span class="w"> </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">local-identifier-list</span><span class="p">]</span><span class="w"> </span><span class="l">&quot;)&quot;</span>
</pre></div>
</div>
<section id="id71">
<h5>Overview<a class="headerlink" href="#id71" title="Link to this heading">#</a></h5>
<p>Yield returns values from an if or for instruction.</p>
</section>
<section id="id72">
<h5>Operands<a class="headerlink" href="#id72" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1…</p></td>
<td><p>boolean-type / number-type / coopmatrix-type</p></td>
<td><p>value</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<section id="spmd-instructions">
<h3>SPMD instructions<a class="headerlink" href="#spmd-instructions" title="Link to this heading">#</a></h3>
<section id="builtin-spmd">
<h4>Builtin (SPMD)<a class="headerlink" href="#builtin-spmd" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">spmd-builtin-type</span><span class="w">       </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;subgroup_id&quot;</span><span class="w"> </span><span class="nc">comp3</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;subgroup_linear_id&quot;</span><span class="w">     </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;subgroup_local_id&quot;</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">spmd-builtin-type</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">integer-type</span>
</pre></div>
</div>
<section id="id73">
<h5>Overview<a class="headerlink" href="#id73" title="Link to this heading">#</a></h5>
<p>Returns a builtin value.</p>
<p>The mode of the subgroup id is selected with the .x, .y, and .z suffix.
Each mode starts with zero and is limited by the corresponding num_subgroups mode. That is,</p>
<div class="math notranslate nohighlight">
\[\forall d \in \{x,y,z\} : 0 \leq \text{subgroup_id}_d &lt; \text{num_subgroups}_d\]</div>
<p>The subgroup linear id combines the x, y, and z modes of the subgroup id as following (note that
that <span class="math notranslate nohighlight">\(\text{subgroup_id}_z = 0\)</span> due to <span class="math notranslate nohighlight">\(\text{num_subgroups}_z = 1\)</span>):</p>
<div class="math notranslate nohighlight">
\[\text{subgroup_linear_id} = \text{subgroup_id}_x +
                            \text{subgroup_id}_y\cdot \text{num_subgroups}_x\]</div>
<p>The subgroup local id is the invocation id within the subgroup and ranges from 0 to subgroup_size-1.</p>
<p>The following table shows the builtins’ description and the types that are returned.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Builtin</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>OpenCL analogue</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>subgroup_id</p></td>
<td><p>i32</p></td>
<td><p>N/A</p></td>
<td><p>Returns the x, y, or z mode of the subgroup id</p></td>
</tr>
<tr class="row-odd"><td><p>subgroup_linear_id</p></td>
<td><p>i32</p></td>
<td><p>get_sub_group_id</p></td>
<td><p>Returns linear subgroup id</p></td>
</tr>
<tr class="row-even"><td><p>subgroup_local_id</p></td>
<td><p>i32</p></td>
<td><p>get_sub_group_local_id</p></td>
<td><p>Returns the local invocation id in the subgroup</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="cooperative-matrix-apply">
<h4>Cooperative matrix apply<a class="headerlink" href="#cooperative-matrix-apply" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">           </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_apply&quot;</span>
<span class="w">                               </span><span class="l">&quot;(&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;)&quot;</span>
<span class="w">                               </span><span class="l">&quot;=&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="w">                               </span><span class="l">&quot;-&gt;&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span><span class="w"> </span><span class="nc">region</span>
</pre></div>
</div>
<section id="id74">
<h5>Overview<a class="headerlink" href="#id74" title="Link to this heading">#</a></h5>
<p>Apply an action on every component of a coopmatrix and update the component with the result of the action.
The action is described in the <em>parallel region</em> of the instruction.</p>
</section>
<section id="id75">
<h5>Arguments<a class="headerlink" href="#id75" title="Link to this heading">#</a></h5>
<p>The first three local identifier introduce SSA values for the row index, column index, and component value.
The row and columns values have i32 type and the component value has the same component type as the resulting
coopmatrix type.
The fourth identifer, after “in”, gives the input coopmatrix, and its type must match the result type.</p>
<p>The region must yield exactly one value whose scalar type is identical to the component type of the coopmatrix.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="mi">0</span> <span class="o">=</span> <span class="o">...</span> <span class="p">;</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">coopmatrix</span> <span class="n">of</span> <span class="nb">type</span> <span class="n">coopmatrix</span><span class="o">&lt;</span><span class="n">f32x16x16</span><span class="p">,</span><span class="n">matrix_acc</span><span class="o">&gt;</span>
<span class="o">%</span><span class="mi">1</span> <span class="o">=</span> <span class="n">cooperative_matrix_apply</span> <span class="p">(</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="o">%</span><span class="n">j</span><span class="p">,</span><span class="o">%</span><span class="n">v</span><span class="p">)</span><span class="o">=%</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">coopmatrix</span><span class="o">&lt;</span><span class="n">f32x16x16</span><span class="p">,</span><span class="n">matrix_acc</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="o">%</span><span class="n">mask</span> <span class="o">=</span> <span class="n">cmp</span><span class="o">.</span><span class="n">le</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="o">%</span><span class="n">j</span> <span class="p">:</span> <span class="nb">bool</span>
    <span class="o">%</span><span class="n">exp_v_masked</span> <span class="o">=</span> <span class="k">if</span> <span class="o">%</span><span class="n">mask</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">f32</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">%</span><span class="n">exp_v</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">native_exp</span> <span class="o">%</span><span class="n">v</span> <span class="p">:</span> <span class="n">f32</span>
        <span class="k">yield</span> <span class="p">(</span><span class="o">%</span><span class="n">exp_v</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="o">%</span><span class="n">zero</span> <span class="o">=</span> <span class="n">constant</span> <span class="mf">0.0</span> <span class="p">:</span> <span class="n">f32</span>
        <span class="k">yield</span> <span class="p">(</span><span class="o">%</span><span class="n">zero</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">yield</span> <span class="p">(</span><span class="o">%</span><span class="n">exp_v_masked</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">;</span> <span class="n">The</span> <span class="n">entries</span> <span class="n">of</span> <span class="o">%</span><span class="mi">1</span> <span class="n">are</span> <span class="n">given</span> <span class="n">by</span> <span class="o">%</span><span class="mi">1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">%</span><span class="mi">0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="k">else</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
</section>
<section id="cooperative-matrix-atomic-load">
<h4>Cooperative matrix atomic load<a class="headerlink" href="#cooperative-matrix-atomic-load" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w"> </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_atomic_load&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">checked-flag</span><span class="p">]</span>
<span class="w">                                                      </span><span class="p">[</span>memory_<span class="nc">scope</span><span class="p">]</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">semantics</span><span class="p">]</span>
<span class="w">                     </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                     </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id76">
<h5>Overview<a class="headerlink" href="#id76" title="Link to this heading">#</a></h5>
<p>Atomic matrix load. Atomic is meant component-wise, there is no atomicity w.r.t. to the whole matrix.
The default scope is “work_group” and the default memory semantics is “relaxed”.</p>
<p>Except for atomicity, the instruction is idential to the <a class="reference internal" href="#cooperative-matrix-load"><span class="std std-ref">Cooperative matrix load</span></a> instruction.</p>
</section>
</section>
<section id="cooperative-matrix-atomic-store">
<h4>Cooperative matrix atomic store<a class="headerlink" href="#cooperative-matrix-atomic-store" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_atomic_store&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">checked-flag</span><span class="p">]</span>
<span class="w">                                                     </span><span class="p">[</span>memory_<span class="nc">scope</span><span class="p">]</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">semantics</span><span class="p">]</span>
<span class="w">                   </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="w">                   </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
</pre></div>
</div>
<section id="id77">
<h5>Overview<a class="headerlink" href="#id77" title="Link to this heading">#</a></h5>
<p>Atomic matrix store. Atomic is meant component-wise, there is no atomicity w.r.t. to the whole matrix.
The default scope is “work_group” and the default memory semantics is “relaxed”.</p>
<p>Except for atomicity, the instruction is idential to the <a class="reference internal" href="#cooperative-matrix-store"><span class="std std-ref">Cooperative matrix store</span></a> instruction.</p>
</section>
</section>
<section id="cooperative-matrix-atomic-update">
<h4>Cooperative matrix atomic update<a class="headerlink" href="#cooperative-matrix-atomic-update" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">cooperative-matrix-atomic-update-op</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_atomic_add&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                                      </span><span class="l">&quot;cooperative_matrix_atomic_max&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                                      </span><span class="l">&quot;cooperative_matrix_atomic_min&quot;</span>
<span class="nc">value-instruction</span><span class="w"> </span><span class="o">=/</span><span class="w"> </span><span class="nc">cooperative-matrix-atomic-update-op</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">checked-flag</span><span class="p">]</span>
<span class="w">                                                         </span><span class="p">[</span>memory_<span class="nc">scope</span><span class="p">]</span><span class="w"> </span><span class="p">[</span>memory_<span class="nc">semantics</span><span class="p">]</span>
<span class="w">                     </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="w">                     </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                     </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id78">
<h5>Overview<a class="headerlink" href="#id78" title="Link to this heading">#</a></h5>
<p>Atomic matrix update. Atomic is meant component-wise, there is no atomicity w.r.t. to the whole matrix.
The default scope is “work_group” and the default memory semantics is “relaxed”.</p>
<p>See <a class="reference internal" href="#cooperative-matrix-store"><span class="std std-ref">Cooperative matrix store</span></a> instruction for further description.</p>
</section>
</section>
<section id="cooperative-matrix-construct">
<h4>Cooperative matrix construct<a class="headerlink" href="#cooperative-matrix-construct" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_construct&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id79">
<h5>Overview<a class="headerlink" href="#id79" title="Link to this heading">#</a></h5>
<p>Returns a coopmatrix whose entries are initialized to the given <em>dynamically uniform</em> number.
The type of the number must match the component type of the coopmatrix type.</p>
</section>
<section id="id80">
<h5>Operands<a class="headerlink" href="#id80" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p>Number</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id81">
<h5>Restrictions<a class="headerlink" href="#id81" title="Link to this heading">#</a></h5>
<p>The number <strong>must</strong> be <em>dynamically uniform</em>.</p>
</section>
</section>
<section id="cooperative-matrix-extract">
<h4>Cooperative matrix extract<a class="headerlink" href="#cooperative-matrix-extract" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_extract&quot;</span>
<span class="w">                            </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;]&quot;</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">number-type</span>
</pre></div>
</div>
<section id="id82">
<h5>Overview<a class="headerlink" href="#id82" title="Link to this heading">#</a></h5>
<p>Return an element of the coopmatrix’s work-item vector.
The index is supplied in square brackets and must be greater or equal than zero
and smaller than the length of the work-item vector, cf. <a class="reference internal" href="../dev/coopmatrix_layout.html#coopmatrix-layout"><span class="std std-ref">Coopmatrix layout</span></a>.</p>
<p>The scalar type of the returned value must match the component type of the coopmatrix.</p>
</section>
<section id="id83">
<h5>Operands<a class="headerlink" href="#id83" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>Cooperative matrix</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>integer-constant</p></td>
<td><p>Index into work-item vector</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="cooperative-matrix-insert">
<h4>Cooperative matrix insert<a class="headerlink" href="#cooperative-matrix-insert" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_insert&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                            </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;]&quot;</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id84">
<h5>Overview<a class="headerlink" href="#id84" title="Link to this heading">#</a></h5>
<p>Return a copy the coopmatrix, while modifying one entry of the coopmatrix.
The index is supplied in square brackets and must be greater or equal than zero
and smaller than the length of the work-item vector, cf. <a class="reference internal" href="../dev/coopmatrix_layout.html#coopmatrix-layout"><span class="std std-ref">Coopmatrix layout</span></a>.</p>
<p>The coopmatrix type of the returned value must match the coopmatrix type of the incoming matrix.
The scalar type of the inserted scalar must match the component type of the coopmatrix.</p>
</section>
<section id="id85">
<h5>Operands<a class="headerlink" href="#id85" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p>Inserted scalar</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>Cooperative matrix</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>integer-constant</p></td>
<td><p>Index into work-item vector</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="cooperative-matrix-load">
<span id="id86"></span><h4>Cooperative matrix load<a class="headerlink" href="#cooperative-matrix-load" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">           </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_load&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">checked-flag</span><span class="p">]</span>
<span class="w">                               </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
<span class="w">                               </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
<span class="nc">checked-flag</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;.rows_checked&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;.cols_checked&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;.both_checked&quot;</span>
</pre></div>
</div>
<section id="id87">
<h5>Overview<a class="headerlink" href="#id87" title="Link to this heading">#</a></h5>
<p>Load a cooperative matrix from a 2d-memref at the position given by the indices in square brackets.
The position gives the starting row and column index, that is,
when a coopmatrix of size <span class="math notranslate nohighlight">\(X\times Y\)</span> is loaded from memref <span class="math notranslate nohighlight">\(M\)</span> at
position <span class="math notranslate nohighlight">\(x, y\)</span>, then the components <span class="math notranslate nohighlight">\(A_{ij}\)</span> of the coopmatrix are given by</p>
<div class="math notranslate nohighlight">
\[\forall i \in [0,X), j \in [0,Y): A_{ij} := M[(x + i) S_1 + (y + j) S_2],\]</div>
<p>where <span class="math notranslate nohighlight">\(S_1\)</span> and <span class="math notranslate nohighlight">\(S_2\)</span> are the entries of the memref’s stride array.
When the transpose modifier “.t” is given, we have</p>
<div class="math notranslate nohighlight">
\[\forall i \in [0,X), j \in [0,Y): A_{ij} := M[(x + j) S_1 + (y + i) S_2]\]</div>
<p>When the checked flag is set, the following out-of-bound checks are added
(with memref shape <span class="math notranslate nohighlight">\(s_1\times s_2\)</span>):</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.n.rows_checked</p></td>
<td><p><span class="math notranslate nohighlight">\(A_{ij} := M[...] \text{ if } 0 \leq x+i &lt; s_1 \text{ else } 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>.t.rows_checked</p></td>
<td><p><span class="math notranslate nohighlight">\(A_{ij} := M[...] \text{ if } 0 \leq y+i &lt; s_2 \text{ else } 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>.n.cols_checked</p></td>
<td><p><span class="math notranslate nohighlight">\(A_{ij} := M[...] \text{ if } 0 \leq y+j &lt; s_2 \text{ else } 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>.t.cols_checked</p></td>
<td><p><span class="math notranslate nohighlight">\(A_{ij} := M[...] \text{ if } 0 \leq x+j &lt; s_1 \text{ else } 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>.n.both_checked</p></td>
<td><p>.n.rows_checked.n and .n.cols_checked</p></td>
</tr>
<tr class="row-odd"><td><p>.t.both_checked</p></td>
<td><p>.t.rows_checked.t and .t.cols_checked</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id88">
<h5>Operands<a class="headerlink" href="#id88" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>memref-type</p></td>
<td><p>M</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>index</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>index</p></td>
<td><p>y</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id89">
<h5>Restrictions<a class="headerlink" href="#id89" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{order}(M) = 2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{component_type}(A) = \text{element_type}(M)\)</span></p></li>
<li><p>All arguments <strong>must</strong> be dynamically uniform.</p></li>
</ul>
</section>
</section>
<section id="cooperative-matrix-mul-add">
<h4>Cooperative matrix mul add<a class="headerlink" href="#cooperative-matrix-mul-add" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">           </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_mul_add&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                               </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id90">
<h5>Overview<a class="headerlink" href="#id90" title="Link to this heading">#</a></h5>
<p>Matrix mul add returns the value of</p>
<div class="math notranslate nohighlight">
\[D := AB + C,\]</div>
<p>where A, B, and C are matrices given by the three operands.</p>
<p>The number of rows of matrix A,C, and D must be a multiple of the subgroup size.</p>
</section>
<section id="id91">
<h5>Operands<a class="headerlink" href="#id91" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Use</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>matrix_a</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>matrix_b</p></td>
<td><p>B</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>matrix_acc</p></td>
<td><p>C</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id92">
<h5>Restrictions<a class="headerlink" href="#id92" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\forall X\in\{A,C,D\}: \text{rows}(X) \bmod \text{subgroup_size} = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{columns}(A) = \text{rows}(B)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rows}(C) = \text{rows}(A) \land \text{columns}(C) = \text{columns}(B)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{shape}(D) = \text{shape}(C)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{use}(D) = \text{matrix_acc}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{promote}(\text{component_type}(A), \text{component_type}(B)) \preceq \text{component_type}(C)\)</span></p></li>
<li><p>Cast of <span class="math notranslate nohighlight">\(\text{component_type}(C)\)</span> to <span class="math notranslate nohighlight">\(\text{component_type}(D)\)</span> must be allowed</p></li>
</ul>
</section>
</section>
<section id="cooperative-matrix-prefetch">
<h4>Cooperative matrix prefetch<a class="headerlink" href="#cooperative-matrix-prefetch" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_prefetch&quot;</span><span class="w"> </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                    </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;]&quot;</span><span class="w"> </span><span class="l">&quot;,&quot;</span>
<span class="w">                    </span><span class="nc">integer-constant</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">integer-constant</span>
</pre></div>
</div>
<section id="id93">
<h5>Overview<a class="headerlink" href="#id93" title="Link to this heading">#</a></h5>
<p>Cooperatively prefetch memory into device cache.
The cache level is given by the first non-negative integer constant, where “0” is the cache closest the core
and core distance increases with increasing cache level.
The prefetch instruction is ignored if the cache level does not exist in the target device.
The position in square brackets gives the starting row and column index.
The last two positive integer constants give the size of the memory region to fetch (in rows by columns).
The following memory locations are prefetched:</p>
<div class="math notranslate nohighlight">
\[\{\forall i \in [0,X), j \in [0,Y): M[(x + i) S_1 + (y + j) S_2]\}\]</div>
<p>Prefetch is an optimization hint and may be disregarded by the compiler.</p>
</section>
<section id="id94">
<h5>Operands<a class="headerlink" href="#id94" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>integer-constant</p></td>
<td><p>Cache-level</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>M</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>index</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>index</p></td>
<td><p>y</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>integer-constant</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>integer-constant</p></td>
<td><p>Y</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id95">
<h5>Restrictions<a class="headerlink" href="#id95" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>All arguments <strong>must</strong> be dynamically uniform.</p></li>
</ul>
</section>
</section>
<section id="cooperative-matrix-reduce">
<h4>Cooperative matrix reduce<a class="headerlink" href="#cooperative-matrix-reduce" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">coopmatrix-reduce-op</span><span class="w">    </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;cooperative_matrix_reduce_add&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;cooperative_matrix_reduce_max&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                           </span><span class="l">&quot;cooperative_matrix_reduce_min&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">coopmatrix-reduce-op</span><span class="w"> </span><span class="nc">reduce-mode</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
<span class="nc">reduce-mode</span><span class="w">             </span><span class="o">=</span><span class="w">  </span><span class="l">&quot;.row&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="l">&quot;.column&quot;</span>
</pre></div>
</div>
<section id="id96">
<h5>Overview<a class="headerlink" href="#id96" title="Link to this heading">#</a></h5>
<p>Computes the sum, maximum, or minimum over either the rows or columns of a coopmatrix.</p>
<p>The component type and use of the the returned value’s coopmatrix type
must match the component type and use of the incoming matrix.</p>
<p>For a row reduction the resulting shape must be <span class="math notranslate nohighlight">\(M\times 1\)</span> and for a column reduction
the resulting shape must be <span class="math notranslate nohighlight">\(1\times N\)</span>, where the shape of the incoming matrix is <span class="math notranslate nohighlight">\(M\times N\)</span>.</p>
</section>
<section id="id97">
<h5>Operands<a class="headerlink" href="#id97" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>Incoming cooperative matrix</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id98">
<h5>Restrictions<a class="headerlink" href="#id98" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{rows}(A) \bmod \text{subgroup_size} = 0\)</span></p></li>
</ul>
</section>
</section>
<section id="cooperative-matrix-scale">
<h4>Cooperative matrix scale<a class="headerlink" href="#cooperative-matrix-scale" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">           </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_scale&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="w">                               </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">coopmatrix-type</span>
</pre></div>
</div>
<section id="id99">
<h5>Overview<a class="headerlink" href="#id99" title="Link to this heading">#</a></h5>
<p>Scale a coopmatrix by a scalar.
The scalar type of the scalar and the component type of the coopmatrix must match,
and the returned must have the same coopmatrix type as the matrix operand.</p>
</section>
<section id="id100">
<h5>Operands<a class="headerlink" href="#id100" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p>scalar</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>matrix</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id101">
<h5>Restrictions<a class="headerlink" href="#id101" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{type}(scalar) = \text{component_type}(matrix)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{type}(result) = \text{type}(matrix)\)</span></p></li>
</ul>
</section>
</section>
<section id="cooperative-matrix-store">
<span id="id102"></span><h4>Cooperative matrix store<a class="headerlink" href="#cooperative-matrix-store" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">instruction</span><span class="w">     </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;cooperative_matrix_store&quot;</span><span class="w"> </span><span class="p">[</span><span class="nc">transpose</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nc">checked-flag</span><span class="p">]</span>
<span class="w">                   </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span>
<span class="w">                   </span><span class="l">&quot;[&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;]&quot;</span>
</pre></div>
</div>
<section id="id103">
<h5>Overview<a class="headerlink" href="#id103" title="Link to this heading">#</a></h5>
<p>Store a cooperative matrix value in a 2d-memref at the position given by the indices in square brackets.
The position gives the starting row and column index, that is,
when a coopmatrix of size <span class="math notranslate nohighlight">\(X\times Y\)</span> is written to memref <span class="math notranslate nohighlight">\(M\)</span> at
position <span class="math notranslate nohighlight">\(x, y\)</span>, then the components <span class="math notranslate nohighlight">\(A_{ij}\)</span> of the coopmatrix are written to</p>
<div class="math notranslate nohighlight">
\[\forall i \in [0,X), j \in [0,Y): M[(x + i) S_1 + (y + j) S_2] := A_{ij},\]</div>
<p>where <span class="math notranslate nohighlight">\(S_1\)</span> and <span class="math notranslate nohighlight">\(S_2\)</span> are the entries of the memref’s stride array.
When the transpose modifier “.t” is given, we have</p>
<div class="math notranslate nohighlight">
\[\forall i \in [0,X), j \in [0,Y): M[(x + j) S_1 + (y + i) S_2] := A_{ij}\]</div>
<p>When the checked flag is set, the following out-of-bound checks are added
(with memref shape <span class="math notranslate nohighlight">\(s_1\times s_2\)</span>):</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.n.rows_checked</p></td>
<td><p>Only execute store if <span class="math notranslate nohighlight">\(0 \leq x+i &lt; s_1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>.t.rows_checked</p></td>
<td><p>Only execute store if <span class="math notranslate nohighlight">\(0 \leq y+i &lt; s_2\)</span></p></td>
</tr>
<tr class="row-even"><td><p>.n.cols_checked</p></td>
<td><p>Only execute store if <span class="math notranslate nohighlight">\(0 \leq y+j &lt; s_2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>.t.cols_checked</p></td>
<td><p>Only execute store if <span class="math notranslate nohighlight">\(0 \leq x+j &lt; s_1\)</span></p></td>
</tr>
<tr class="row-even"><td><p>.n.both_checked</p></td>
<td><p>.n.rows_checked + .n.cols_checked</p></td>
</tr>
<tr class="row-odd"><td><p>.t.both_checked</p></td>
<td><p>.t.rows_checked + .t.cols_checked</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id104">
<h5>Operands<a class="headerlink" href="#id104" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>coopmatrix-type</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>memref-type</p></td>
<td><p>M</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>index</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>index</p></td>
<td><p>y</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id105">
<h5>Restrictions<a class="headerlink" href="#id105" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{component_type}(A) = \text{element_type}(B)\)</span></p></li>
<li><p>All arguments <strong>must</strong> be dynamically uniform.</p></li>
</ul>
</section>
</section>
<section id="subgroup-broadcast">
<h4>Subgroup broadcast<a class="headerlink" href="#subgroup-broadcast" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="l">&quot;subgroup_broadcast&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;,&quot;</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">number-type</span>
</pre></div>
</div>
<section id="id106">
<h5>Overview<a class="headerlink" href="#id106" title="Link to this heading">#</a></h5>
<p>Broadcast a scalar to all work-items in the subgroup.
The scalar type of the first operand and the type of the result must match.
The second identifier must have i32 type.</p>
</section>
<section id="id107">
<h5>Operands<a class="headerlink" href="#id107" title="Link to this heading">#</a></h5>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Op.-No.</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>number-type</p></td>
<td><p>Value that is to be distributed to all work-items of the sub-group</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>i32</p></td>
<td><p>Subgroup local index that identifies the work-item whose value is returned to all other work-items</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id108">
<h5>Restrictions<a class="headerlink" href="#id108" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>The second operand <strong>must</strong> be dynamically uniform.</p></li>
</ul>
</section>
</section>
<section id="subgroup-operation">
<h4>Subgroup operation<a class="headerlink" href="#subgroup-operation" title="Link to this heading">#</a></h4>
<div class="highlight-abnf notranslate"><div class="highlight"><pre><span></span><span class="nc">subgroup-operation-type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">&quot;subgroup_exclusive_scan_add&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_exclusive_scan_max&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_exclusive_scan_min&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_inclusive_scan_add&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_inclusive_scan_max&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_inclusive_scan_min&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_reduce_add&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_reduce_max&quot;</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="l">&quot;subgroup_reduce_min&quot;</span>
<span class="nc">value-instruction</span><span class="w">       </span><span class="o">=/</span><span class="w"> </span><span class="nc">subgroup-operation-type</span><span class="w"> </span><span class="nc">local-identifier</span><span class="w"> </span><span class="l">&quot;:&quot;</span><span class="w"> </span><span class="nc">number-type</span>
</pre></div>
</div>
<section id="id109">
<h5>Overview<a class="headerlink" href="#id109" title="Link to this heading">#</a></h5>
<p>Let <span class="math notranslate nohighlight">\([x_0,x_1,\dots,x_{n-1}]\)</span> be the input vector contributed by a subgroup of size <em>n</em>.
(The work-item with subgroup local id <em>i</em> contributes <span class="math notranslate nohighlight">\(x_i\)</span>.)
Let <span class="math notranslate nohighlight">\(\diamond\)</span> be the binary operator and <em>I</em> the identity.
We define the output vector of size <em>n</em> for the group operations in the following table:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Operation type</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>exclusive_scan</p></td>
<td><p><span class="math notranslate nohighlight">\([I, x_0, (x_0 \diamond x_1), \dots, x_0 \diamond x_1 \diamond \dots \diamond x_{n-2}]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>inclusive_scan</p></td>
<td><p><span class="math notranslate nohighlight">\([x_0, (x_0 \diamond x_1), \dots, x_0 \diamond x_1 \diamond \dots \diamond x_{n-1}]\)</span></p></td>
</tr>
<tr class="row-even"><td><p>reduce</p></td>
<td><p><span class="math notranslate nohighlight">\([s,s,\dots,s] \text{ with } s := x_0 \diamond \dots \diamond x_{n-1}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="add">
<h5>Add<a class="headerlink" href="#add" title="Link to this heading">#</a></h5>
<p>Computes the subgroup operation with <span class="math notranslate nohighlight">\(\diamond:=+\)</span> and <span class="math notranslate nohighlight">\(I:=0\)</span>.</p>
</section>
<section id="max">
<h5>Max<a class="headerlink" href="#max" title="Link to this heading">#</a></h5>
<p>Computes the subgroup operation with <span class="math notranslate nohighlight">\(\diamond:=\max\)</span> and identity as given in the following table:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Identity</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer-type</p></td>
<td><p>Smallest integer representable by integer type</p></td>
</tr>
<tr class="row-odd"><td><p>floating-type</p></td>
<td><p><span class="math notranslate nohighlight">\(-\infty\)</span></p></td>
</tr>
<tr class="row-even"><td><p>complex type</p></td>
<td><p>Forbidden</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="min">
<h5>Min<a class="headerlink" href="#min" title="Link to this heading">#</a></h5>
<p>Computes the subgroup operation with <span class="math notranslate nohighlight">\(\diamond:=\min\)</span> and identity as given in the following table:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Identity</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer-type</p></td>
<td><p>Largest integer representable by integer type</p></td>
</tr>
<tr class="row-odd"><td><p>floating-type</p></td>
<td><p><span class="math notranslate nohighlight">\(+\infty\)</span></p></td>
</tr>
<tr class="row-even"><td><p>complex type</p></td>
<td><p>Forbidden</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="calling_convention.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Calling convention</p>
      </div>
    </a>
    <a class="right-next"
       href="preprocessor.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Preprocessor reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execution-model">Execution model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-rules">Core rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifier">Identifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-attributes">Parameter attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restrictions">Restrictions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regions">Regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boolean-type">Boolean type</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-types">Scalar types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memref-type">Memref type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-layout">Memory layout</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#strided-layout">Strided layout</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alignment-attribute">Alignment attribute</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#greatest-common-divisor-gcd-attributes">Greatest common divisor (GCD) attributes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-type">Group type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#group-attributes">Attributes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-type">Cooperative matrix type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Definitions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collective-instructions">Collective instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alloca">Alloca</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Attributes</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axpby">Axpby</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#operands">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-sum">Cumulative sum</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach">Foreach</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach-tile">Foreach tile</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Restrictions</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gemm">GEMM</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gemv">GEMV</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ger">GER</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hadamard-product">Hadamard product</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel">Parallel</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">Sum</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-instructions">Additional instructions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixed-instructions">Mixed instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-binary">Arithmetic (binary)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-unary">Arithmetic (unary)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#associated">Associated</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#returns">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-load">Atomic load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-store">Atomic store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-update">Atomic update</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#barrier">Barrier</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#builtin-mixed">Builtin (mixed)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cast">Cast</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison">Comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#constant">Constant</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#expand">Expand</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for">For</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#arguments">Arguments</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">Returns</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">Attributes</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fuse">Fuse</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id55">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id57">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#if">If</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id58">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id59">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load">Load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id60">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id61">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id62">Returns</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#math-unary">Math (unary)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id63">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#size">Size</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id64">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id65">Operands</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subview">Subview</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id66">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id67">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#store">Store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id68">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id69">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id70">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#yield">Yield</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id71">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id72">Operands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spmd-instructions">SPMD instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#builtin-spmd">Builtin (SPMD)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id73">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-apply">Cooperative matrix apply</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id74">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id75">Arguments</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-atomic-load">Cooperative matrix atomic load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id76">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-atomic-store">Cooperative matrix atomic store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id77">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-atomic-update">Cooperative matrix atomic update</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id78">Overview</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-construct">Cooperative matrix construct</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id79">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id80">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id81">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-extract">Cooperative matrix extract</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id82">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id83">Operands</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-insert">Cooperative matrix insert</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id84">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id85">Operands</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-load">Cooperative matrix load</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id87">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id88">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id89">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-mul-add">Cooperative matrix mul add</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id90">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id91">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id92">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-prefetch">Cooperative matrix prefetch</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id93">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id94">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id95">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-reduce">Cooperative matrix reduce</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id96">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id97">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id98">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-scale">Cooperative matrix scale</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id99">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id100">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id101">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cooperative-matrix-store">Cooperative matrix store</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id103">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id104">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id105">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subgroup-broadcast">Subgroup broadcast</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id106">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id107">Operands</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id108">Restrictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subgroup-operation">Subgroup operation</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id109">Overview</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#add">Add</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#max">Max</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#min">Min</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Intel
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Intel Corporation.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>